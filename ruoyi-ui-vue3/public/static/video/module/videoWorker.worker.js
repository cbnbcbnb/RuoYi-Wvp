!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";var a=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserDetect=function(){var e=navigator.userAgent.toLowerCase(),t=navigator.appName,r=null;"Microsoft Internet Explorer"===t||e.indexOf("trident")>-1||e.indexOf("edge/")>-1?(r="ie","Microsoft Internet Explorer"===t?(e=/msie ([0-9]{1,}[\.0-9]{0,})/.exec(e),r+=parseInt(e[1])):e.indexOf("trident")>-1?r+=11:e.indexOf("edge/")>-1&&(r="edge")):e.indexOf("safari")>-1?r=e.indexOf("chrome")>-1?"chrome":"safari":e.indexOf("firefox")>-1&&(r="firefox");return r},t.BrowserDetectDetail=function(){var e=navigator.userAgent.toLowerCase(),t=navigator.platform.toLowerCase(),r=e.match(/(opera|ie|trident|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|rv:(\d.?)|$)/)||[null,"unknown",0],a=("ie"==r[1]||"trident"==r[1])&&document.documentMode,n={name:"version"==r[1]?r[3]:"trident"==r[1]?"ie":r[1],version:a||parseFloat("opera"==r[1]&&r[4]?r[4]:"trident"==r[1]&&r[5]?r[5]:r[2]),Platform:{name:e.match(/ip(?:ad|od|hone)/)?"ios":(e.match(/(?:webos|android)/)||t.match(/mac|win|linux/)||["other"])[0]}};n[n.name]=!0,n[n.name+parseInt(n.version,10)]=!0,n.Platform[n.Platform.name]=!0,n.Platform.ios&&(n.Platform.ipod=!0);n.Engine={};var i=function(e,t){n.Engine.name=e,n.Engine[e+t]=!0,n.Engine.version=t};if(n.ie)switch(n.Engine.trident=!0,n.version){case 6:i("trident",4);break;case 7:i("trident",5);break;case 8:i("trident",6)}n.firefox&&(n.Engine.gecko=!0,n.version>=3?i("gecko",19):i("gecko",18));if(n.safari||n.chrome)switch(n.Engine.webkit=!0,n.version){case 2:i("webkit",419);break;case 3:i("webkit",420);break;case 4:i("webkit",525)}n.opera&&(n.Engine.presto=!0,n.version>=9.6?i("presto",960):n.version>=9.5?i("presto",950):i("presto",925));if("unknown"==n.name)switch((e.match(/(?:webkit|khtml|gecko)/)||[])[0]){case"webkit":case"khtml":n.Engine.webkit=!0;break;case"gecko":n.Engine.gecko=!0}return n},t.CommonAudioUtil=function(){var e=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384],t=function(e,t,r){var a=0,n=0;for(a=0;a<r&&!(e<t[n]);a++)n++;return a},r=function(r,a){var n=0,i=0,o=0,s=0,u=0;return i=t(n=r>0?r:8191&-r,e,15)-6,o=i+(a>>6&15)-13,s=(0===n?32:i>=0?n>>i:n<<-i)*(a&parseInt("077",8))+48>>4,u=o>=0?s<<o&32767:s>>-o,(r^a)<0?-u:u};this.g726InitState=function(){var e={},t=0;for(e.pp=new Array(2),e.zp=new Array(6),e.pk=new Array(2),e.dq=new Array(6),e.sr=new Array(2),e.yl=34816,e.yu=544,e.dms=0,e.dml=0,e.ppp=0,t=0;t<2;t++)e.pp[t]=0,e.pk[t]=0,e.sr[t]=32;for(t=0;t<6;t++)e.zp[t]=0,e.dq[t]=32;return e.td=0,e},this.predictorZero=function(e){var t=0,a=0;for(a=r(e.zp[0]>>2,e.dq[0]),t=1;t<6;t++)a+=r(e.zp[t]>>2,e.dq[t]);return a},this.predictorPole=function(e){return r(e.pp[1]>>2,e.sr[1])+r(e.pp[0]>>2,e.sr[0])},this.stepSize=function(e){var t=0,r=0,a=0;return e.ppp>=256?e.yu:(t=e.yl>>6,r=e.yu-t,a=e.ppp>>2,r>0?t+=r*a>>6:r<0&&(t+=r*a+63>>6),t)},this.quantize=function(r,a,n,i){var o=0,s=0,u=0;return o=Math.abs(r),s=t(o>>1,e,15),u=t((s<<7)+(o<<7>>s&127)-(a>>2),n,i),r<0?1+(i<<1)-u:0===u?1+(i<<1):u},this.reconstruct=function(e,t,r){var a=0,n=0;return(a=t+(r>>2))<0?e?-32768:0:(n=128+(127&a)<<7>>14-(a>>7&15),e?n-32768:n)},this.update=function(r,a,n,i,o,s,u,f){var l=0,c=0,p=0,d=0,m=0,_=0,h=0,g=0,v=0,y=0,b=0,D=0,S=0,T=0;if(T=u<0?1:0,c=32767&o,v=f.yl>>15,D=f.yl>>10&31,S=32+D<<v,b=(y=v>9?31744:S)+(y>>1)>>1,g=0===f.td?0:c<=b?0:1,f.yu=a+(n-a>>5),f.yu<544?f.yu=544:f.yu>5120&&(f.yu=5120),f.yl+=f.yu+(-f.yl>>6),1===g)f.pp[0]=0,f.pp[1]=0,f.zp[0]=0,f.zp[1]=0,f.zp[2]=0,f.zp[3]=0,f.zp[4]=0,f.zp[5]=0,d=0;else for(_=T^f.pk[0],d=f.pp[1]-(f.pp[1]>>7),0!==u&&((h=_?f.pp[0]:-f.pp[0])<-8191?d-=256:d+=h>8191?255:h>>5,T^f.pk[1]?d<=-12160?d=-12288:d>=12416?d=12288:d-=128:d<=-12416?d=-12288:d>=12160?d=12288:d+=128),f.pp[1]=d,f.pp[0]-=f.pp[0]>>8,0!==u&&(0===_?f.pp[0]+=192:f.pp[0]-=192),m=15360-d,f.pp[0]<-m?f.pp[0]=-m:f.pp[0]>m&&(f.pp[0]=m),l=0;l<6;l++)f.zp[l]-=5===r?f.zp[l]>>9:f.zp[l]>>8,32767&o&&((o^f.dq[l])>=0?f.zp[l]+=128:f.zp[l]-=128);for(l=5;l>0;l--)f.dq[l]=f.dq[l-1];return 0===c?f.dq[0]=o>=0?32:64544:(p=t(c,e,15),f.dq[0]=o>=0?(p<<6)+(c<<6>>p):(p<<6)+(c<<6>>p)-1024),f.sr[1]=f.sr[0],0===s?f.sr[0]=32:s>0?(p=t(s,e,15),f.sr[0]=(p<<6)+(s<<6>>p)):s>-32768?(p=t(c=-s,e,15),f.sr[0]=(p<<6)+(c<<6>>p)-1024):f.sr[0]=64544,f.pk[1]=f.pk[0],f.pk[0]=T,f.td=1===g?0:d<-11776?1:0,f.dms+=i-f.dms>>5,f.dml+=(i<<2)-f.dml>>7,1===g?f.ppp=256:a<1536?f.ppp+=512-f.ppp>>4:1===f.td?f.ppp+=512-f.ppp>>4:Math.abs((f.dms<<2)-f.dml)>=f.dml>>3?f.ppp+=512-f.ppp>>4:f.ppp+=-f.ppp>>4,f}},t.Texture=t.Shader=t.Script=t.Queue=t.Program=t.PLAYER_STATE_CODE=void 0,t.VideoBufferList=function(){var e=0,t=0,r=null;function a(){e=360,t=240,r=null,this._length=0,this.head=null,this.tail=null,this.curIdx=0}return a.prototype={push:function(e,a,n,i,o,s){var u=new VideoBufferNode(e,a,n,i,o,s);return this._length>0?(this.tail.next=u,u.previous=this.tail,this.tail=u):(this.head=u,this.tail=u),this._length+=1,null!==r&&this._length>=t&&r(),u},pop:function(){var e=null;return this._length>1&&(e=this.head,this.head=this.head.next,null!==this.head?this.head.previous=null:this.tail=null,this._length-=1),e},setMaxLength:function(t){(e=t)>360?e=360:e<30&&(e=30)},setBUFFERING:function(e){(t=e)>240?t=240:t<6&&(t=6)},setBufferFullCallback:function(e){r=e},searchTimestamp:function(e){var t=this.head,r=this._length,a=1;if(0===r||e<=0||null===t)throw new Error("Failure: non-existent node in this list.");for(;null!==t&&(t.timeStamp.timestamp!==e.timestamp||t.timeStamp.timestamp_usec!==e.timestamp_usec);)t=t.next,a++;return r<a?t=null:this.curIdx=a,t},findIFrame:function(e){var t=this.head,r=this._length,a=1;if(0===r)throw new Error("Failure: non-existent node in this list.");for(;a<this.curIdx;)t=t.next,a++;if(!0===e)for(;"I"!==t.frameType;)t=t.next,a++;else for(;"I"!==t.frameType;)t=t.previous,a--;return r<a?t=null:this.curIdx=a,t}},new a},t.debug=t.commonOption=void 0,t.formAuthorizationResponse=function(e,t,r,a,n,i){var s=null,u=null;return s=(0,o.default)(e+":"+a+":"+t).toLowerCase(),u=(0,o.default)(i+":"+r).toLowerCase(),(0,o.default)(s+":"+n+":"+u).toLowerCase()},t.pubsub=void 0,t.stringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(new ArrayBuffer(t)),a=0;a<t;a++)r[a]=e.charCodeAt(a);return r};var n=a(r(6)),i=a(r(7)),o=a(r(8)),s={log:function(){},error:function(){},count:function(){},info:function(){}};t.debug=s;var u={};t.commonOption=u,u.VIDEOENCODETYPE={H264:1,H265:2};t.PLAYER_STATE_CODE={TIMEOUT:101,NOT_SUPPORT_MIME:102,LIMIT_SPEED:103,ADDBUFFER_ERROR:104,MSE_ERROR:105,UNSUPPORTED_AUDIO_FORMAT:201,OPEN_WS_ERROR:202,KMS_NOT_CONNECTED:203,CHANNEL_AUTH_FAILED:204,PASSWORD_NOT_INITIALIZE:205,MAX_NUMBER_CONNECTION:206,WS_CLOSED:207,RTSP_NOT_FOUND:404,INVALID_RANGE:457,INTERNAL_SERVER_ERROR:500,SERVICE_UNAVILABLE:503,TALK_SERVICE_UNAVILABLE:504};var f=function(){function e(){}return e.createFromElementId=function(t){for(var r=document.getElementById(t),a="",n=r.firstChild;n;)3===n.nodeType&&(a+=n.textContent),n=n.nextSibling;var i=new e;return i.type=r.type,i.source=a,i},e.createFromSource=function(t,r){var a=new e;return a.type=t,a.source=r,a},e}();t.Script=f;var l=function(){return function(e,t){if("x-shader/x-fragment"===t.type)this.shader=e.createShader(e.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==t.type)return void error("Unknown shader type: "+t.type);this.shader=e.createShader(e.VERTEX_SHADER)}e.shaderSource(this.shader,t.source),e.compileShader(this.shader),e.getShaderParameter(this.shader,e.COMPILE_STATUS)||error("An error occurred compiling the shaders: "+e.getShaderInfoLog(this.shader))}}();t.Shader=l;var c=function(){function e(e){this.gl=e,this.program=this.gl.createProgram()}return e.prototype={attach:function(e){this.gl.attachShader(this.program,e.shader)},link:function(){this.gl.linkProgram(this.program)},use:function(){this.gl.useProgram(this.program)},getAttributeLocation:function(e){return this.gl.getAttribLocation(this.program,e)},setMatrixUniform:function(e,t){var r=this.gl.getUniformLocation(this.program,e);this.gl.uniformMatrix4fv(r,!1,t)}},e}();t.Program=c;var p=function(){var e=null;function t(e,t,r){this.gl=e,this.size=t,this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),this.format=r||e.LUMINANCE,e.texImage2D(e.TEXTURE_2D,0,this.format,t.w,t.h,0,this.format,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.pixelStorei(e.UNPACK_ALIGNMENT,1)}return t.prototype={fill:function(e,t){var r=this.gl;r.bindTexture(r.TEXTURE_2D,this.texture),t?r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.size.w,this.size.h,this.format,r.UNSIGNED_BYTE,e):r.texImage2D(r.TEXTURE_2D,0,this.format,this.size.w,this.size.h,0,this.format,r.UNSIGNED_BYTE,e)},bind:function(t,r,a){var n=this.gl;e||(e=[n.TEXTURE0,n.TEXTURE1,n.TEXTURE2]),n.activeTexture(e[t]),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(n.getUniformLocation(r.program,a),t)}},t}();t.Texture=p;var d=function(){function e(){(0,n.default)(this,e),this.first=null,this.size=0}return(0,i.default)(e,[{key:"enqueue",value:function(e){if(null===this.first)this.first=e;else{for(var t=this.first;null!==t.next;)t=t.next;t.next=e}this.size+=1}},{key:"dequeue",value:function(){var e=null;return null!==this.first&&(e=this.first,this.first=this.first.next,this.size-=1),e}},{key:"clear",value:function(){this.size=0,this.first=null}}]),e}();t.Queue=d;var m={},_=-1,h={publish:function(e,t){if(!m[e])return!1;for(var r=m[e],a=r?r.length:0;a--;)r[a].func(t);return this},subscribe:function(e,t){m[e]||(m[e]=[]);var r=(++_).toString();return m[e].push({token:r,func:t}),r},unsubscribe:function(e){for(var t in m)if(m[t])for(var r=0,a=m[t].length;r<a;r++)if(m[t][r].token===e)return m[t].splice(r,1),e},getTopicFunc:function(e){return m[e]?m[e]:[]}};t.pubsub=h},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(0),n=function(e){var t=[],r={},n=e||a.commonOption.VIDEOENCODETYPE.H264;function i(){for(var e in t)t[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)];a.commonOption.VIDEOENCODETYPE.H264===n?r.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]):a.commonOption.VIDEOENCODETYPE.H265===n&&(r.FTYP=new Uint8Array([105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,97,118,99,49,109,112,52,49])),r.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),r.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),r.STSC=r.STCO=r.STTS,r.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),r.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),r.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),r.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}t={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],hev1:[],hvcC:[]};var o=function(e){for(var t=8,r=Array.prototype.slice.call(arguments,1),a=0;a<r.length;a++)t+=r[a].byteLength;var n=new Uint8Array(t),i=0;for(n[i++]=t>>>24&255,n[i++]=t>>>16&255,n[i++]=t>>>8&255,n[i++]=255&t,n.set(e,i),i+=4,a=0;a<r.length;a++)n.set(r[a],i),i+=r[a].byteLength;return n},s=function(e){return o(t.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),function(e){var r=e.config,a=r.length,n=new Uint8Array([0,0,0,0,3,23+a,0,1,0,4,15+a,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([a]).concat(r).concat([6,1,2]));return o(t.esds,n)}(e))},u=function(e){return"audio"===e.type?o(t.stsd,r.STSD_PREFIX,s(e)):o(t.stsd,r.STSD_PREFIX,function(e){var r=e.sps||[],i=e.pps||[],s=[],u=[],f=[],l=e.vps||[],c=0;for(c=0;c<l.length;c++)f.push((65280&l[c].byteLength)>>>8),f.push(255&l[c].byteLength),f=f.concat(Array.prototype.slice.call(l[c]));for(c=0;c<r.length;c++)s.push((65280&r[c].byteLength)>>>8),s.push(255&r[c].byteLength),s=s.concat(Array.prototype.slice.call(r[c]));for(c=0;c<i.length;c++)u.push((65280&i[c].byteLength)>>>8),u.push(255&i[c].byteLength),u=u.concat(Array.prototype.slice.call(i[c]));return a.commonOption.VIDEOENCODETYPE.H264===n?o(t.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(t.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length]).concat(s).concat([i.length]).concat(u)))):a.commonOption.VIDEOENCODETYPE.H265===n?o(t.hev1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(t.hvcC,new Uint8Array([1,e.general_profile_flag,(4278190080&e.general_profile_compatibility_flags)>>>24,(16711680&e.general_profile_compatibility_flags)>>>16,(65280&e.general_profile_compatibility_flags)>>>8,255&e.general_profile_compatibility_flags,(0xff0000000000&e.general_constraint_indicator_flags)>>>40,(0xff00000000&e.general_constraint_indicator_flags)>>>32,(4278190080&e.general_constraint_indicator_flags)>>>24,(16711680&e.general_constraint_indicator_flags)>>>16,(65280&e.general_constraint_indicator_flags)>>>8,255&e.general_constraint_indicator_flags,e.general_level_idc,240,0,252,252|e.chroma_format_idc,248|e.bitDepthLumaMinus8,248|e.bitDepthChromaMinus8,0,0,e.rate_layers_nested_length,3].concat([32,0,1]).concat(f).concat([33,0,1]).concat(s).concat([34,0,1]).concat(u)))):void 0}(e))},f=function(e){var a=null;return a="audio"===e.type?o(t.smhd,r.SMHD):o(t.vmhd,r.VMHD),o(t.minf,a,o(t.dinf,o(t.dref,r.DREF)),function(e){return o(t.stbl,u(e),o(t.stts,r.STTS),o(t.stsc,r.STSC),o(t.stsz,r.STSZ),o(t.stco,r.STCO))}(e))},l=function(e){return o(t.mdia,function(e){var r=e.timescale,a=e.duration;return o(t.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,a>>>24&255,a>>>16&255,a>>>8&255,255&a,85,196,0,0]))}(e),function(e){var a=null;return a="audio"===e.type?r.HDLR_AUDIO:r.HDLR_VIDEO,o(t.hdlr,a)}(e),f(e))},c=function(e){return o(t.trak,function(e){var r=e.id,a=e.duration,n=e.width,i=e.height;return o(t.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,255&n,0,0,i>>>8&255,255&i,0,0]))}(e),l(e))},p=function(e){return o(t.mvex,function(e){var r=e.id,a=new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return o(t.trex,a)}(e))},d=function(e){var r,n,i=(r=e.timescale,n=e.duration,a.debug.log("mvhd:  timescale: "+r+"  duration: "+n),o(t.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),s=c(e),u=p(e);return o(t.moov,i,s,u)},m=function(e,r){return"audio"===e.type?audioTrun(e,r):function(e,r){var a,n=null,i=null,s=0,u=r;if(null===(a=e.samples||[])[0].frameDuration)for(u+=24+4*a.length,n=trunHeader(a,u),s=0;s<a.length;s++)i=a[s],n=n.concat([(4278190080&i.size)>>>24,(16711680&i.size)>>>16,(65280&i.size)>>>8,255&i.size]);else for(n=function(e,t){return[0,0,3,5,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t,0,0,0,0]}(a,u+=24+4*a.length+4*a.length),s=0;s<a.length;s++)i=a[s],n=n.concat([(4278190080&i.frameDuration)>>>24,(16711680&i.frameDuration)>>>16,(65280&i.frameDuration)>>>8,255&i.frameDuration,(4278190080&i.size)>>>24,(16711680&i.size)>>>16,(65280&i.size)>>>8,255&i.size]);return o(t.trun,new Uint8Array(n))}(e,r)},_=function(e,r){return o(t.moof,function(e){var r=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return o(t.mfhd,r)}(e),function(e){var r,a,n;return r=o(t.tfhd,new Uint8Array([0,2,0,0,0,0,0,1])),a=o(t.tfdt,new Uint8Array([0,0,0,0,e.baseMediaDecodeTime>>>24&255,e.baseMediaDecodeTime>>>16&255,e.baseMediaDecodeTime>>>8&255,255&e.baseMediaDecodeTime])),n=m(e,72),o(t.traf,r,a,n)}(r))};return i.prototype={initSegment:function(e){var n=o(t.ftyp,r.FTYP);a.debug.log(e);var i=d(e),s=new Uint8Array(n.byteLength+i.byteLength);return s.set(n,0),s.set(i,n.byteLength),s},mediaSegment:function(e,r,a,n){var i=_(e,r),s=function(e){return o(t.mdat,e)}(a),u=null;return(u=new Uint8Array(i.byteLength+s.byteLength)).set(i),u.set(s,i.byteLength),u}},new i};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){this.map={}};a.prototype={put:function(e,t){this.map[e]=t},get:function(e){return this.map[e]},containsKey:function(e){return e in this.map},containsValue:function(e){for(var t in this.map)if(this.map[t]===e)return!0;return!1},isEmpty:function(e){return 0===this.size()},clear:function(){for(var e in this.map)delete this.map[e]},remove:function(e){delete this.map[e]},keys:function(){var e=new Array;for(var t in this.map)e.push(t);return e},values:function(){var e=new Array;for(var t in this.map)e.push(this.map[t]);return e},size:function(){var e=0;for(var t in this.map)e++;return e}};var n=a;t.default=n},function(e,t,r){"use strict";var a=r(1),n=a(r(5)),i=a(r(11)),o=a(r(13)),s=a(r(15)),u=r(0);importScripts("/module/libDecodeSDK.js"),addEventListener("message",function(e){var t=e.data;switch(b=e.data.channelId,t.type){case"sdpInfo":l=t.data,0,function(e){f=[],m=!1;for(var t=0;t<e.sdpInfo.length;t++){if(c=null,p=e.decodeMode,"SVAC2"===e.sdpInfo[t].codecName||"H264"===e.sdpInfo[t].codecName||"RAW"===e.sdpInfo[t].codecName&&e.mp4Codec&&"H264"===e.mp4Codec.VideoCodec)null===h&&(h=(0,n.default)()),(c=h).init(e.decodeMode),c.setFramerate(e.sdpInfo[t].Framerate),c.setGovLength(e.govLength),c.setCheckDelay(e.checkDelay),c.setLessRate(e.lessRateCanvas);else if("H265"===e.sdpInfo[t].codecName||"RAW"===e.sdpInfo[t].codecName&&e.mp4Codec&&"H265"===e.mp4Codec.VideoCodec){null===g&&(g=(0,i.default)()),c=g;var r={};r.h265AccelerationEnabled=e.h265AccelerationEnabled,c.init(r),c.setFramerate(e.sdpInfo[t].Framerate),c.setGovLength(e.govLength),c.setCheckDelay(e.checkDelay)}else"JPEG"===e.sdpInfo[t].codecName?(null===v&&(v=(0,o.default)()),(c=v).init(),c.setFramerate(e.sdpInfo[t].Framerate)):"stream-assist-frame"===e.sdpInfo[t].codecName&&(u.debug.log(e.sdpInfo[t]),null===y&&(y=(0,s.default)()),(c=y).init());"undefined"!==typeof e.sdpInfo[t].Framerate&&e.sdpInfo[t].Framerate,null!==c&&(c.setBufferfullCallback(S),c.setReturnCallback(T),_=e.sdpInfo[t].RtpInterlevedID,f[_]=c)}}(l);break;case"MediaData":if(!0===m){!function(e){_=e.data.rtspInterleave[1],"undefined"!==typeof f[_]&&f[_].bufferingRtpData(e.data.rtspInterleave,e.data.header,e.data.payload)}(t);break}_=t.data.rtspInterleave[1],"undefined"!==typeof f[_]&&f[_].parseRTPData(t.data.rtspInterleave,t.data.payload,d,D,t.info,t.channel);break;case"initStartTime":f[_].initStartTime();break;case"end":w("end")}},!1),Module.onRuntimeInitialized=function(){Module._DECODE_Init(),w("WorkerReady")};var f=[],l=null,c=null,p="",d=!1,m=!1,_=-1,h=null,g=null,v=null,y=null,b=null,D=1;function S(){f[_].findCurrent(),w("stepPlay","BufferFull")}function T(e){var t=null;if(null===e||"undefined"===typeof e)return t=null,void null;if("undefined"!==typeof e.error?(w("error",e.error),t=e.decodedData):(t=e.decodedData,null!==e.decodeMode&&"undefined"!==typeof e.decodeMode&&(p=e.decodeMode,w("setVideoTagMode",e.decodeMode))),null!=e.decodeStart&&(w("DecodeStart",e.decodeStart),p=e.decodeStart.decodeMode),null!==t&&"undefined"!==typeof t)if(void 0!==t.frameData&&null!==t.frameData&&"canvas"===p){!0===t.frameData.firstFrame&&w("firstFrame",t.frameData.firstFrame);var r={bufferIdx:t.frameData.bufferIdx,width:t.frameData.width,height:t.frameData.height,codecType:t.frameData.codecType,frameType:t.frameData.frameType,timeStamp:null,frameIndex:t.frameData.frameIndex};null!==t.timeStamp&&"undefined"!==typeof t.timeStamp&&(r.timeStamp=t.timeStamp),w("videoInfo",r),"undefined"!==typeof t.frameData.data&&null!==t.frameData.data&&w("canvasRender",t.frameData.data,t.frameData.option)}else if(null!==t.frameData&&"video"===p){null!==t.initSegmentData&&(w("codecInfo",t.codecInfo),w("initSegment",t.initSegmentData));r={codecType:t.frameData.codecType,frameIndex:t.frameData.frameIndex};"undefined"!==typeof t.frameData.width&&(r.width=t.frameData.width,r.height=t.frameData.height),w("videoInfo",r),w("videoTimeStamp",t.timeStamp),t.frameData.length>0&&(w("mediaSample",t.mediaSample),w("videoRender",t.frameData))}else w("drop",e.decodedData);null!=e.resolution&&w("MSEResolutionChanged",e.resolution),null!=e.ivsDraw&&w("ivsDraw",e)}function w(e,t,r){var a={type:e,data:t,channelId:b,option:r};"canvasRender"===e?postMessage(a,[t.buffer]):postMessage(a)}},function(e,t,r){"use strict";var a=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=a(r(10)),o=a(r(2)),s=a(r(3));function u(){var e=7,t=7,r=2,a=3,n=4,i=5,o=8,u=16,f=32,l=255,c=0,p=null;function d(){c=0,p=new s.default}function m(r,n){var i=n,o=c+i>>a;return i=c+n&e,r[o]>>t-(i&t)&1}function _(e,t){var r=c>>a,n=8*(r+1)-c;if(n<8)for(var i=0;i<3;i++){var o=e[r+i];o=0==i?o>>n<<n:2==i?o&255>>8-n|1<<n:0,e.set([o],r+i)}else e.set([0],r),e.set([1],r+1)}function h(e,t){var r=0;if(1===t)r=m(e,0);else for(var a=0;a<t;a++)r=(r<<1)+m(e,a);return c+=t,r}function g(e,t){for(var a=0,n=0,i=t;c+i<8*e.length&&!m(e,i++);)a++;if(0===a)return c+=1,0;n=1<<a;for(var o=a-1;o>=0;o--,i++)n|=m(e,i)<<o;return c+=a*r+1,n-1}function v(e,t){var a=g(e,t);return 1&a?(a+1)/r:-a/r}function y(e){p.put("cpb_cnt_minus1",g(e,0)),p.put("bit_rate_scale",h(e,n)),p.put("cpb_size_scale",h(e,n));for(var t=p.get("cpb_cnt_minus1"),r=new Array(t),a=new Array(t),o=new Array(t),s=0;s<=t;s++)r[s]=g(e,0),a[s]=g(e,0),o[s]=h(e,1);p.put("bit_rate_value_minus1",r),p.put("cpb_size_value_minus1",a),p.put("cbr_flag",o),p.put("initial_cpb_removal_delay_length_minus1",h(e,i)),p.put("cpb_removal_delay_length_minus1",h(e,i)),p.put("dpb_output_delay_length_minus1",h(e,i)),p.put("time_offset_length",h(e,i))}return d.prototype={parse:function(e){c=0,p.clear(),p.put("forbidden_zero_bit",h(e,1)),p.put("nal_ref_idc",h(e,r)),p.put("nal_unit_type",h(e,i)),p.put("profile_idc",h(e,o)),p.put("profile_compatibility",h(e,o)),p.put("level_idc",h(e,o)),p.put("seq_parameter_set_id",g(e,0));var t=p.get("profile_idc");if((100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t||138===t||139===t||134===t)&&(p.put("chroma_format_idc",g(e,0)),p.get("chroma_format_idc")===a&&p.put("separate_colour_plane_flag",h(e,1)),p.put("bit_depth_luma_minus8",g(e,0)),p.put("bit_depth_chroma_minus8",g(e,0)),p.put("qpprime_y_zero_transform_bypass_flag",h(e,1)),p.put("seq_scaling_matrix_present_flag",h(e,1)),p.get("seq_scaling_matrix_present_flag"))){for(var n=p.get("chroma_format_idc")!==a?o:12,s=new Array(n),d=0;d<n;d++)if(s[d]=h(e,1),s[d])for(var m=d<6?u:64,b=8,D=8,S=0;S<m;S++)D&&(D=(b+v(e,0)+256)%256),b=0===D?b:D;p.put("seq_scaling_list_present_flag",s)}if(p.put("log2_max_frame_num_minus4",g(e,0)),p.put("pic_order_cnt_type",g(e,0)),0===p.get("pic_order_cnt_type"))p.put("log2_max_pic_order_cnt_lsb_minus4",g(e,0));else if(1===p.get("pic_order_cnt_type")){p.put("delta_pic_order_always_zero_flag",h(e,1)),p.put("offset_for_non_ref_pic",v(e,0)),p.put("offset_for_top_to_bottom_field",v(e,0)),p.put("num_ref_frames_in_pic_order_cnt_cycle",g(e,0));for(var T=0;T<p.get("num_ref_frames_in_pic_order_cnt_cycle");T++)p.put("num_ref_frames_in_pic_order_cnt_cycle",v(e,0))}return p.put("num_ref_frames",g(e,0)),p.put("gaps_in_frame_num_value_allowed_flag",h(e,1)),p.put("pic_width_in_mbs_minus1",g(e,0)),p.put("pic_height_in_map_units_minus1",g(e,0)),p.put("frame_mbs_only_flag",h(e,1)),0===p.get("frame_mbs_only_flag")&&p.put("mb_adaptive_frame_field_flag",h(e,1)),p.put("direct_8x8_interence_flag",h(e,1)),p.put("frame_cropping_flag",h(e,1)),1===p.get("frame_cropping_flag")&&(p.put("frame_cropping_rect_left_offset",g(e,0)),p.put("frame_cropping_rect_right_offset",g(e,0)),p.put("frame_cropping_rect_top_offset",g(e,0)),p.put("frame_cropping_rect_bottom_offset",g(e,0))),p.put("vui_parameters_present_flag",h(e,1)),p.get("vui_parameters_present_flag")&&function(e){p.put("aspect_ratio_info_present_flag",h(e,1)),p.get("aspect_ratio_info_present_flag")&&(p.put("aspect_ratio_idc",h(e,o)),p.get("aspect_ratio_idc")===l&&(_(e),p.put("sar_width",h(e,u)),_(e),p.put("sar_height",h(e,u)))),p.put("overscan_info_present_flag",h(e,1)),p.get("overscan_info_present_flag")&&p.put("overscan_appropriate_flag",h(e,1)),p.put("video_signal_type_present_flag",h(e,1)),p.get("video_signal_type_present_flag")&&(p.put("video_format",h(e,a)),p.put("video_full_range_flag",h(e,1)),p.put("colour_description_present_flag",h(e,1)),p.get("colour_description_present_flag")&&(p.put("colour_primaries",h(e,o)),p.put("transfer_characteristics",h(e,o)),p.put("matrix_coefficients",h(e,o)))),p.put("chroma_loc_info_present_flag",h(e,1)),p.get("chroma_loc_info_present_flag")&&(p.put("chroma_sample_loc_type_top_field",g(e,0)),p.put("chroma_sample_loc_type_bottom_field",g(e,0))),p.put("timing_info_present_flag",h(e,1)),p.get("timing_info_present_flag")&&(p.put("num_units_in_tick",h(e,f)),p.put("time_scale",h(e,f)),p.put("fixed_frame_rate_flag",h(e,1))),p.put("nal_hrd_parameters_present_flag",h(e,1)),p.get("nal_hrd_parameters_present_flag")&&y(e),p.put("vcl_hrd_parameters_present_flag",h(e,1)),p.get("vcl_hrd_parameters_present_flag")&&y(e),(p.get("nal_hrd_parameters_present_flag")||p.get("vcl_hrd_parameters_present_flag"))&&p.put("low_delay_hrd_flag",h(e,1)),p.put("pic_struct_present_flag",h(e,1)),p.put("bitstream_restriction_flag",h(e,1)),p.get("bitstream_restriction_flag")&&(p.put("motion_vectors_over_pic_boundaries_flag",h(e,1)),p.put("max_bytes_per_pic_denom",g(e,0)),p.put("max_bits_per_mb_denom",g(e,0)))}(e),!0},getSizeInfo:function(){var e=0,t=0;0===p.get("chroma_format_idc")?e=t=0:1===p.get("chroma_format_idc")?e=t=r:p.get("chroma_format_idc")===r?(e=r,t=1):p.get("chroma_format_idc")===a&&(0===p.get("separate_colour_plane_flag")?e=t=1:1===p.get("separate_colour_plane_flag")&&(e=t=0));var n=p.get("pic_width_in_mbs_minus1")+1,i=p.get("pic_height_in_map_units_minus1")+1,o=(r-p.get("frame_mbs_only_flag"))*i,s=0,f=0,l=0,c=0;1===p.get("frame_cropping_flag")&&(s=p.get("frame_cropping_rect_left_offset"),f=p.get("frame_cropping_rect_right_offset"),l=p.get("frame_cropping_rect_top_offset"),c=p.get("frame_cropping_rect_bottom_offset"));var d=n*u*(o*u);return{width:n*u-e*(s+f),height:o*u-t*(r-p.get("frame_mbs_only_flag"))*(l+c),decodeSize:d}},getSpsValue:function(e){return p.get(e)},getCodecInfo:function(){var e='video/mp4;codecs="avc1.';return e=e+p.get("profile_idc").toString(u)+(p.get("profile_compatibility")<15?"0"+p.get("profile_compatibility").toString(u):p.get("profile_compatibility").toString(u))+p.get("level_idc").toString(u)+'"'}},new d}var f=function(){var e=0,t=0,r=!1,a=(new Uint8Array(1048576),new Uint8Array(["0x00","0x00","0x00","0x01"]),new u),s=0,f=null,l=null,c=0,p=!1,d={frameData:null,timeStamp:null,initSegmentData:null,mediaSample:null,dropPercent:0,dropCount:0,codecInfo:"",playback:!1},m={timestamp:null,timezone:null},_={},h=null,g=null,v=!1,y=!1,b=0,D=0,S=0,T=!0,w=0,E=!1,M=0,C=null,I=null,A="",x=null,k=0,O=0,P={width:0,height:0},F=null,L=!1,R=null,U={SVAC2:15};function B(e){e!==A&&("video"===e?A="video":(A="canvas",p=!0,d.frameData.firstFrame=!0))}function z(e,t,r,a){var n="";return e*t>921600&&!1===r&&a.encode_type!==U.SVAC2?(n="video",L&&k>0&&k<=3&&(n="canvas")):n="canvas",n}function N(){this.decoder=new i.default,this.firstDiffTime=0,this.firstTime=0,this.lastMSW=0}return N.prototype={setReturnCallback:function(e){this.rtpReturnCallback=e},setBufferfullCallback:function(e){null!==this.videoBufferList&&this.videoBufferList.setBufferFullCallback(e)},getVideoBuffer:function(e){if(null!==this.videoBufferList)return this.videoBufferList.searchNodeAt(e)},clearBuffer:function(){null!==this.videoBufferList&&this.videoBufferList.clear()},findCurrent:function(){null!==this.videoBufferList&&this.videoBufferList.searchTimestamp(this.getTimeStamp())},setTimeStamp:function(e){this.timeData=e},getTimeStamp:function(){return this.timeData},ntohl:function(e){return(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3]>>>0},appendBuffer:function(e,t,r){if(r+t.length>=e.length){var a=new Uint8Array(e.length+1048576);a.set(e,0),e=a}return e.set(t,r),e},getFramerate:function(){return k},setGovLength:function(e){x=e},getGovLength:function(){return x},setDecodingTime:function(e){this.decodingTime=e},getDropPercent:function(){return 0},getDropCount:function(){return 0},initStartTime:function(){this.firstDiffTime=0,this.calcGov=0},setCheckDelay:function(e){this.checkDelay=e},init:function(e){v=!1,r=!1,A=e,this.decoder.setIsFirstFrame(!1),this.videoBufferList=new n.VideoBufferList,this.firstDiffTime=0,this.checkDelay=!0,this.timeData=null},setFramerate:function(e){0<e&&"undefined"!==typeof e&&(k=e,null!==this.videoBufferList&&(this.videoBufferList.setMaxLength(6*k),this.videoBufferList.setBUFFERING(4*k)))},parseRTPData:function(i,u,x,k,L){var N,V=null,j={},H=(u[19]<<24)+(u[18]<<16)+(u[17]<<8)+u[16]>>>0;N=H>>26===0?"2000":"20"+(H>>26);var W=Date.UTC(N,(H>>22&15)-1,H>>17&31,H>>12&31,H>>6&63,63&H)/1e3;if(L.timeStampmsw,W+=(new Date).getTimezoneOffset()/60*3600,A||253!==u[4]||(F=0!==u[5],A=z(L.width,L.height,F,L)),""!==A){if(0==this.firstTime)this.firstTime=W,this.lastMSW=0,I=(u[21]<<8)+u[20],m={timestamp:this.firstTime,timestamp_usec:0};else{var G,X=(u[21]<<8)+u[20];G=X>I?X-I:X+65535-I,this.lastMSW+=G,W>this.firstTime&&(this.lastMSW-=1e3),this.firstTime=W,m={timestamp:W,timestamp_usec:this.lastMSW},I=X}0!==this.getFramerate()&&"undefined"!==typeof this.getFramerate()||"undefined"===typeof this.getTimeStamp()||(this.setFramerate(Math.round(1e3/((m.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(m.timestamp_usec-this.getTimeStamp().timestamp_usec)))),n.debug.log("setFramerate"+Math.round(1e3/((m.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(m.timestamp_usec-this.getTimeStamp().timestamp_usec))))),this.setTimeStamp(m);for(var q=u[22],Y=u.subarray(24+q,u.length-8),J=u.subarray(u.length-8,u.length),K=(J[7],J[6],J[5],J[4],[]),Z=0;Z<=Y.length;)if(0==Y[Z])if(0==Y[Z+1])if(1==Y[Z+2]){if(K.push(Z),5==(31&Y[Z+=3])||1==(31&Y[Z]))break}else 0==Y[Z+2]?Z++:Z+=3;else Z+=2;else Z+=1;var Q="P";e=(u[21]<<8)+u[20];var $=0;if(L.encode_type===U.SVAC2){var ee={};ee.width=L.width,ee.height=L.height,S=L.width,w=L.height,s=ee.width*L.height,Q=L.IPFrame,!0===T&&(j.decodeStart=ee,j.decodeStart.decodeMode="canvas",j.decodeStart.encodeMode="h264"),T=!1}else for(Z=0;Z<K.length;Z++)switch(V=Y.subarray(K[Z]+3,K[Z+1]),31&Y[K[Z]+3]){default:break;case 1:Q="P",$=K[Z]-1;break;case 5:Q="I",$=K[Z]-1;break;case 28:break;case 7:a.parse(V);var te=L;s=a.getSizeInfo().decodeSize,null!==f&&null!==l&&f.width===te.width&&f.height===te.height&&l===a.getCodecInfo()||(v=!1,f=te,l=a.getCodecInfo(),this.decoder.setIsFirstFrame(!1)),S=b=te.width,w=D=te.height,h=V,P.width==te.width&&P.height==te.height||(0!=P.width?(P.width=te.width,P.height=te.height,j.resolution=P,j.resolution.decodeMode=z(P.width,P.height,F),j.resolution.encodeMode="h264"):(P.width=te.width,P.height=te.height,j.decodeStart=P,j.decodeStart.decodeMode=A,j.decodeStart.encodeMode="h264"));break;case 8:g=V;break;case 6:case 9:}if(x&&!1===p&&(j.backupData={stream:new Uint8Array(Y),frameType:Q,width:S,height:w,codecType:"h264"},null!==m.timestamp&&"undefined"!==typeof m.timestamp?j.backupData.timestamp_usec=m.timestamp_usec:j.backupData.timestamp=(e/90).toFixed(0)),"canvas"===A){var re=1e3*m.timestamp+m.timestamp_usec;if(0==this.firstDiffTime?(c=0,this.firstDiffTime=Date.now()-re,n.debug.log("firstDiff: "+O)):(re-C<0&&(this.firstDiffTime=c+(Date.now()-re).toFixed(0)),(c=Date.now()-re-this.firstDiffTime)<0&&(this.firstDiffTime=0,c=0),c>8e3&&(j.error={errorCode:n.PLAYER_STATE_CODE.TIMEOUT},this.rtpReturnCallback(j))),C=re,t!==s&&(this.decoder.free(),t=s,this.decoder.setOutputSize(t)),L.encode_type!==U.SVAC2){if(!0===p&&"P"===Q)return;!0===p&&(p=!1)}d.frameData=null,!0===x&&!0===r||(d.frameData=this.decoder.decode(u)),d.timeStamp=null,m=null===m.timestamp?this.getTimeStamp():m,d.timeStamp=m}else{var ae=null;if(v?d.initSegmentData=null:(v=!0,L={id:1,width:b,height:D,type:"video",profileIdc:a.getSpsValue("profile_idc"),profileCompatibility:0,levelIdc:a.getSpsValue("level_idc"),sps:[h],pps:[g],timescale:1e3,fps:this.getFramerate()},n.debug.log(JSON.stringify(L)),null==R&&(R=new o.default(n.commonOption.VIDEOENCODETYPE.H264)),d.initSegmentData=R.initSegment(L),d.codecInfo=a.getCodecInfo()),$||n.debug.log("11111111111111111111111111111111111111111"),"I"===Q){var ne=$;ae=Y.subarray(ne,Y.length)}else ae=Y.subarray($,Y.length);var ie=ae.length-4;ae[0]=(4278190080&ie)>>>24,ae[1]=(16711680&ie)>>>16,ae[2]=(65280&ie)>>>8,ae[3]=255&ie;var oe=this.getFramerate(),se={duration:Math.round(1/oe*1e3),size:ae.length,frame_time_stamp:null,frameDuration:null};if(r)se.frame_time_stamp=e,d.frameData=new Uint8Array(ae),d.mediaSample=se;else{if(!1===x){if(se.frame_time_stamp=1e3*m.timestamp+m.timestamp_usec-O,!1===y)se.frame_time_stamp=0,O=1e3*m.timestamp+m.timestamp_usec,se.frameDuration=0,_=se,y=!0;else{var ue=_.frame_time_stamp,fe=se.frame_time_stamp;se.frameDuration=Math.abs(fe-ue),se.frameDuration>3e3&&(se.frameDuration=0),_=se}d.frameData=new Uint8Array(ae),d.mediaSample=se}m=null===m.timestamp?this.getTimeStamp():m,d.timeStamp=m}}var le=S*w;if(!0===r&&(NaN.toFixed(0),le>786432?(B("video"),j.decodeMode="video"):(B("canvas"),j.decodeMode="canvas")),d.playback=r,d.frameData.frameIndex=L.frameIndex,j.decodedData=d,!0===E)return"I"===Q&&M++,2===M&&(M=0,E=!1),void n.debug.info("H264Session::stop");this.rtpReturnCallback(j)}},findIFrame:function(){if(null!==this.videoBufferList){var e=this.videoBufferList.findIFrame();if(null===e||"undefined"===typeof e)return!1;var t={};return this.setTimeStamp(e.timeStamp),t.frameData=this.decoder.decode(e.buffer),t.timeStamp=e.timeStamp,t}},setInitSegment:function(){v=!1,f=null,l=null},setLessRate:function(e){L=e}},new N};t.default=f},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";var a=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(9));if("undefined"==typeof i)var i={};i.MD5=function(e){function t(e){var t=(e>>>0).toString(16);return"00000000".substr(0,8-t.length)+t}function r(e,t,r){return e&t|~e&r}function a(e,t,r){return r&e|~r&t}function i(e,t,r){return e^t^r}function o(e,t,r){return t^(e|~r)}function s(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function u(e){for(var t=[],r=0;r<e.length;r++)if(e.charCodeAt(r)<=127)t.push(e.charCodeAt(r));else for(var a=encodeURIComponent(e.charAt(r)).substr(1).split("%"),n=0;n<a.length;n++)t.push(parseInt(a[n],16));return t}function f(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}var l=null,c=null;function p(e,t){return 4294967295&e+t}return"string"==typeof e?l=u(e):e.constructor==Array?0===e.length?l=e:"string"==typeof e[0]?l=function(e){for(var t=[],r=0;r<e.length;r++)t=t.concat(u(e[r]));return t}(e):"number"==typeof e[0]?l=e:c=(0,n.default)(e[0]):"undefined"!=typeof ArrayBuffer?e instanceof ArrayBuffer?l=f(new Uint8Array(e)):e instanceof Uint8Array||e instanceof Int8Array?l=f(e):e instanceof Uint32Array||e instanceof Int32Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Float32Array||e instanceof Float64Array?l=f(new Uint8Array(e.buffer)):c=(0,n.default)(e):c=(0,n.default)(e),c&&alert("MD5 type mismatch, cannot process "+c),function(){function e(e,t,r,a){var n,i,o=y;y=v,v=g,g=p(g,(n=p(h,p(e,p(t,r))))<<(i=a)&4294967295|n>>>32-i),h=o}var n=l.length;l.push(128);var u=l.length%64;if(u>56){for(var f=0;f<64-u;f++)l.push(0);u=l.length%64}for(f=0;f<56-u;f++)l.push(0);l=l.concat(function(e){for(var t=[],r=0;r<8;r++)t.push(255&e),e>>>=8;return t}(8*n));var c=1732584193,d=4023233417,m=2562383102,_=271733878,h=0,g=0,v=0,y=0;for(f=0;f<l.length/64;f++){h=c;var b=64*f;e(r(g=d,v=m,y=_),3614090360,s(l,b),7),e(r(g,v,y),3905402710,s(l,b+4),12),e(r(g,v,y),606105819,s(l,b+8),17),e(r(g,v,y),3250441966,s(l,b+12),22),e(r(g,v,y),4118548399,s(l,b+16),7),e(r(g,v,y),1200080426,s(l,b+20),12),e(r(g,v,y),2821735955,s(l,b+24),17),e(r(g,v,y),4249261313,s(l,b+28),22),e(r(g,v,y),1770035416,s(l,b+32),7),e(r(g,v,y),2336552879,s(l,b+36),12),e(r(g,v,y),4294925233,s(l,b+40),17),e(r(g,v,y),2304563134,s(l,b+44),22),e(r(g,v,y),1804603682,s(l,b+48),7),e(r(g,v,y),4254626195,s(l,b+52),12),e(r(g,v,y),2792965006,s(l,b+56),17),e(r(g,v,y),1236535329,s(l,b+60),22),e(a(g,v,y),4129170786,s(l,b+4),5),e(a(g,v,y),3225465664,s(l,b+24),9),e(a(g,v,y),643717713,s(l,b+44),14),e(a(g,v,y),3921069994,s(l,b),20),e(a(g,v,y),3593408605,s(l,b+20),5),e(a(g,v,y),38016083,s(l,b+40),9),e(a(g,v,y),3634488961,s(l,b+60),14),e(a(g,v,y),3889429448,s(l,b+16),20),e(a(g,v,y),568446438,s(l,b+36),5),e(a(g,v,y),3275163606,s(l,b+56),9),e(a(g,v,y),4107603335,s(l,b+12),14),e(a(g,v,y),1163531501,s(l,b+32),20),e(a(g,v,y),2850285829,s(l,b+52),5),e(a(g,v,y),4243563512,s(l,b+8),9),e(a(g,v,y),1735328473,s(l,b+28),14),e(a(g,v,y),2368359562,s(l,b+48),20),e(i(g,v,y),4294588738,s(l,b+20),4),e(i(g,v,y),2272392833,s(l,b+32),11),e(i(g,v,y),1839030562,s(l,b+44),16),e(i(g,v,y),4259657740,s(l,b+56),23),e(i(g,v,y),2763975236,s(l,b+4),4),e(i(g,v,y),1272893353,s(l,b+16),11),e(i(g,v,y),4139469664,s(l,b+28),16),e(i(g,v,y),3200236656,s(l,b+40),23),e(i(g,v,y),681279174,s(l,b+52),4),e(i(g,v,y),3936430074,s(l,b),11),e(i(g,v,y),3572445317,s(l,b+12),16),e(i(g,v,y),76029189,s(l,b+24),23),e(i(g,v,y),3654602809,s(l,b+36),4),e(i(g,v,y),3873151461,s(l,b+48),11),e(i(g,v,y),530742520,s(l,b+60),16),e(i(g,v,y),3299628645,s(l,b+8),23),e(o(g,v,y),4096336452,s(l,b),6),e(o(g,v,y),1126891415,s(l,b+28),10),e(o(g,v,y),2878612391,s(l,b+56),15),e(o(g,v,y),4237533241,s(l,b+20),21),e(o(g,v,y),1700485571,s(l,b+48),6),e(o(g,v,y),2399980690,s(l,b+12),10),e(o(g,v,y),4293915773,s(l,b+40),15),e(o(g,v,y),2240044497,s(l,b+4),21),e(o(g,v,y),1873313359,s(l,b+32),6),e(o(g,v,y),4264355552,s(l,b+60),10),e(o(g,v,y),2734768916,s(l,b+24),15),e(o(g,v,y),1309151649,s(l,b+52),21),e(o(g,v,y),4149444226,s(l,b+16),6),e(o(g,v,y),3174756917,s(l,b+44),10),e(o(g,v,y),718787259,s(l,b+8),15),e(o(g,v,y),3951481745,s(l,b+36),21),c=p(c,h),d=p(d,g),m=p(m,v),_=p(_,y)}return function(e,r,a,n){for(var i="",o=0,s=0,u=3;u>=0;u--)o=255&(s=arguments[u]),o<<=8,o|=255&(s>>>=8),o<<=8,o|=255&(s>>>=8),o<<=8,i+=t(o|=s>>>=8);return i}(_,m,d,c).toUpperCase()}()};var o=function(e){return i.MD5(e)};t.default=o},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(0);var n=function(){var e,t,r,n,i,o,s,u,f,l,c,p,d,m,_,h=!1,g=0;function v(){v.prototype.setIsFirstFrame(!1)}return v.prototype={init:function(){a.debug.log("H264 Decoder init")},setOutputSize:function(e){if(i!==2*e){i=2*e;var t=Module._malloc(1),r=new Uint8Array(Module.HEAPU8.buffer,t,1);Module._DECODE_GetFreePort(r.byteOffset),g=r[0],r=null,Module._free(t),Module._DECODE_Init(g),o=Module._malloc(5242880),s=new Uint8Array(Module.HEAPU8.buffer,o,5242880);var a=2*e;u=Module._malloc(a),f=new Uint8Array(Module.HEAPU8.buffer,u,a),l=Module._malloc(4),c=new Uint8Array(Module.HEAPU8.buffer,l,4),p=Module._malloc(40),d=new Uint8Array(Module.HEAPU8.buffer,p,40)}},decode:function(a,i){var o=a[4],u=a[5];e=Date.now(),s.set(a),Module._DECODE_InputOneFrame(g,s.byteOffset,a.length,f.byteOffset,c.byteOffset,d.byteOffset),n=d[16]+(d[17]<<8),r=d[18]+(d[19]<<8);var l=n*r*3/2;return _=null,m=null,_=new ArrayBuffer(l),(m=new Uint8Array(_)).set(Module.HEAPU8.subarray(f.byteOffset,f.byteOffset+l)),t=Date.now()-e,v.prototype.isFirstFrame()?n>0&&r>0?(e=Date.now(),{data:m,option:{ylen:n,height:r,mediaType:o,subMediaType:u,beforeDecoding:e},width:n,height:r,codecType:"h264",decodingTime:t,frameType:i}):void 0:(v.prototype.setIsFirstFrame(!0),{firstFrame:!0})},setIsFirstFrame:function(e){h=e},isFirstFrame:function(){return h},free:function(){Module._DECODE_Stop(g),s=null,Module._free(o),f=null,Module._free(u),c=null,Module._free(l),d=null,Module._free(p),_=null,m=null}},new v};t.default=n},function(e,t,r){"use strict";var a=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=a(r(12)),o=a(r(2)),s=a(r(3));function u(){var e=null,t=null,r=0,a=0,n=0,i=0,o=0;function u(){0,e=new s.default}function f(){return 0==n&&(i=function(){if(a>=r)return 0;var e=t[a++];return 0==e?(o++,a<r&&2==o&&3==t[a]&&(a++,o=0)):o=0,e}(),n=8),i>>--n&1}function l(e,t){for(var r=0;t>0;)r<<=1,r|=f(),t--;return r}function c(e,t){for(var n=0;a<r&&0==f();)n++;return l(0,n)+((1<<n)-1)}return u.prototype={parse:function(t){t,0,e.clear(),e.put("forbidden_zero_bit",l(0,1)),e.put("nal_unit_type",l(0,6)),e.put("nuh_layer_id",l(0,6)),e.put("nuh_temporal_id_plus1",l(0,3)),e.put("sps_video_parameter_set_id",l(0,4)),0===e.get("nuh_layer_id")?e.put("sps_max_sub_layers_minus1",l(0,3)):e.put("sps_ext_or_max_sub_layers_minus1",l(0,3));var r=0!==e.get("nuh_layer_id")&&7===e.get("sps_ext_or_max_sub_layers_minus1");return r||(e.put("sps_max_sub_layers_minus1",l(0,1)),function(t,r){if(t){e.put("general_profile_space",l(0,2)),e.put("general_tier_flag",l(0,1)),e.put("general_profile_idc",l(0,5));for(var a=new Array(32),n=0;n<32;n++)a[n]=l(0,1);e.put("general_progressive_source_flag",l(0,1)),e.put("general_interlaced_source_flag",l(0,1)),e.put("general_non_packed_constraint_flag",l(0,1)),e.put("general_frame_only_constraint_flag",l(0,1));var i=e.get("general_profile_idc");4===i||a[4]||5===i||a[5]||6===i||a[6]||7===i||a[7]||8===i||a[8]||9===i||a[9]||10===i||a[10]?(e.put("general_max_12bit_constraint_flag",l(0,1)),e.put("general_max_10bit_constraint_flag",l(0,1)),e.put("general_max_8bit_constraint_flag",l(0,1)),e.put("general_max_422chroma_constraint_flag",l(0,1)),e.put("general_max_420chroma_constraint_flag",l(0,1)),e.put("general_max_monochrome_constraint_flag",l(0,1)),e.put("general_intra_constraint_flag",l(0,1)),e.put("general_one_picture_only_constraint_flag",l(0,1)),e.put("general_lower_bit_rate_constraint_flag",l(0,1)),5===i||a[5]||9===i||a[9]||10===i||a[10]?(e.put("general_max_14bit_constraint_flag",l(0,1)),e.put("general_reserved_zero_33bits",l(0,33))):e.put("general_reserved_zero_34bits",l(0,34))):e.put("general_reserved_zero_43bits",l(0,43)),i>=1&&i<=5||a[1]||a[2]||a[3]||a[4]||a[5]||a[9]?e.put("general_inbld_flag",l(0,1)):e.put("general_reserved_zero_bit",l(0,1))}e.put("general_level_idc",l(0,8));var o=new Array(r),s=new Array(r);for(_=0;_<r;_++)o[_]=l(0,1),s[_]=l(0,1);var u=new Array(8),f=new Array(r),c=new Array(r),p=new Array(r),d=[],m=new Array(r);if(r>0)for(var _=r;_<8;_++)u[_]=l(0,2);for(_=0;_<r;_++){if(o[_]){for(c[_]=l(0,2),p[_]=l(0,1),f[_]=l(0,5),n=0;n<32;n++)d[_][n]=l(0,1);e.put("sub_layer_progressive_source_flag",l(0,1)),e.put("sub_layer_interlaced_source_flag",l(0,1)),e.put("sub_layer_non_packed_constraint_flag",l(0,1)),e.put("sub_layer_frame_only_constraint_flag",l(0,1)),4===f[_]||d[_][4]||5===f[_]||d[_][5]||6===f[_]||d[_][6]||7===f[_]||d[_][7]||8===f[_]||d[_][8]||9===f[_]||d[_][9]||10===f[_]||d[_][10]?(e.put("sub_layer_max_12bit_constraint_flag",l(0,1)),e.put("sub_layer_max_10bit_constraint_flag",l(0,1)),e.put("sub_layer_max_8bit_constraint_flag",l(0,1)),e.put("sub_layer_max_422chroma_constraint_flag",l(0,1)),e.put("sub_layer_max_420chroma_constraint_flag",l(0,1)),e.put("sub_layer_max_monochrome_constraint_flag",l(0,1)),e.put("sub_layer_intra_constraint_flag",l(0,1)),e.put("sub_layer_one_picture_only_constraint_flag",l(0,1)),e.put("sub_layer_lower_bit_rate_constraint_flag",l(0,1)),5===f[_]||d[_][5]?(e.put("sub_layer_max_14bit_constraint_flag",l(0,1)),e.put("sub_layer_lower_bit_rate_constraint_flag",l(0,1)),m[_]=l(0,33)):m[_]=l(0,34)):e.put("sub_layer_reserved_zero_43bits",l(0,43)),f[_]>=1&&f[_]<=5||9==f[_]||d[1]||d[2]||d[3]||d[4]||d[5]||d[9]?e.put("sub_layer_inbld_flag",l(0,1)):e.put("sub_layer_reserved_zero_bit",l(0,1))}s[_]&&e.put("sub_layer_level_idc",l(0,8))}}(1,e.get("sps_max_sub_layers_minus1"))),l(0,84),e.put("sps_seq_parameter_set_id",c()),r?(e.put("update_rep_format_flag",l(0,1)),e.get("update_rep_format_flag")&&e.put("sps_rep_format_idx",l(0,8))):(e.put("chroma_format_idc",c()),3===e.get("chroma_format_idc")&&e.put("separate_colour_plane_flag",l(0,1)),e.put("pic_width_in_luma_samples",c()),e.put("pic_height_in_luma_samples",c()),e.put("conformance_window_flag",l(0,1)),e.get("conformance_window_flag")&&(e.put("conf_win_left_offset",c()),e.put("conf_win_right_offset",c()),e.put("conf_win_top_offset",c()),e.put("conf_win_bottom_offset",c()))),!0},parse2:function(s){var u=s.length;if(s,t=s,r=s.length,a=0,n=0,i=0,o=0,0,e.clear(),u<20)return!1;l(0,16),l(0,4);var f=l(0,3);if(e.put("sps_max_sub_layers_minus1",f),f>6)return!1;l(0,1),l(0,2),l(0,1);l(0,5);l(0,32),l(0,1),l(0,1),l(0,1),l(0,1),l(0,43),l(0,1),e.put("general_level_idc",l(0,8));for(var p=[],d=[],m=0;m<f;m++)p[m]=l(0,1),d[m]=l(0,1);if(f>0)for(m=f;m<8;m++)l(0,2);for(m=0;m<f;m++)p[m]&&(l(0,2),l(0,1),l(0,5),l(0,32),l(0,1),l(0,1),l(0,1),l(0,1),l(0,44)),d[m]&&l(0,8);var _=c();if(e.put("sps_seq_parameter_set_id",_),_>15)return!1;var h=c();return e.put("chroma_format_idc",h),!(_>3)&&(3==h&&l(0,1),e.put("pic_width_in_luma_samples",c()),e.put("pic_height_in_luma_samples",c()),l(0,1)&&(c(),c(),c(),c()),c()==c())},getSizeInfo:function(){var t=e.get("pic_width_in_luma_samples"),r=e.get("pic_height_in_luma_samples");if(e.get("conformance_window_flag")){var a=e.get("chroma_format_idc"),n=e.get("separate_colour_plane_flag");"undefined"===typeof n&&(n=0);var i=1!==a&&2!==a||0!==n?1:2,o=1===a&&0===n?2:1;t-=i*e.get("conf_win_right_offset")+i*e.get("conf_win_left_offset"),r-=o*e.get("conf_win_bottom_offset")+o*e.get("conf_win_top_offset")}return{width:t,height:r,decodeSize:t*r}},getSpsValue:function(t){return e.get(t)}},new u}function f(){var e=7,t=7,r=2,a=3,n=0,i=null;function o(){n=0,i=new s.default}function u(r,i){var o=i,s=n+o>>a;return o=n+i&e,r[s]>>t-(o&t)&1}function f(e,t){return t<=25?l(e,t):l(e,16)<<t-16|l(e,t-16)}function l(e,t){var r=0;if(1===t)r=u(e,0);else for(var a=0;a<t;a++)r=(r<<1)+u(e,a);return n+=t,r}function c(e,t){for(var a=0,i=0,o=t;n+o<8*e.length&&!u(e,o++);)a++;if(0===a)return n+=1,0;i=1<<a;for(var s=a-1;s>=0;s--,o++)i|=u(e,o)<<s;return n+=a*r+1,i-1}return o.prototype={parse:function(e){n=0,i.clear();var t=new ArrayBuffer(256),r=new Uint8Array(t);!function(e,t,r,a){for(var n=0,i=0;n+2<t&&i+2<a;++n)0==e[n]&&0==e[n+1]&&3==e[n+2]?(r[i++]=e[n++],r[i++]=e[n++]):r[i++]=e[n];for(;n<t&&i<a;)r[i++]=e[n++]}(e,e.length,r,256);var a=[],o=[];l(r,4);var s,u,p=l(r,3);i.put("temporalIdNested",l(r,1)),i.put("general_profile_space",l(r,2)),i.put("general_tier_flag",l(r,1)),i.put("general_profile_idc",l(r,5)),i.put("general_profile_compatibility",l(e,8)),i.put("general_profile_compatibility_flags",f(r,32)),i.put("general_constraint_indicator_flags",(s=r,(u=48)<=32?f(s,u):f(s,u-32)<<32|f(s,32))),i.put("general_level_idc",l(r,8));var d=0;for(d=0;d<p&&d<6;d++)a[d]=l(r,1),o[d]=l(r,1);if(p>0)for(d=p;d<8;d++)l(r,2);for(d=0;d<p&&d<6;d++)o[d]&&l(r,8);c(r,0);i.put("chroma_format_idc",c(r,0));c(r,0),c(r,0);return l(r,1),c(r,0),c(r,0),c(r,0),c(r,0),i.put("bitDepthLumaMinus8",c(r,0)+8),i.put("bitDepthChromaMinus8",c(r,0)+8),t=null,r=null,!0},parse2:function(e){var t=e.length,r=e;e.length;if(i.clear(),t<20)return!1;l(r,16),l(r,4);var a=l(r,3);if(i.put("sps_max_sub_layers_minus1",a),a>6)return!1;l(r,1),l(r,2),l(r,1);l(r,5);l(r,32),l(r,1),l(r,1),l(r,1),l(r,1),l(r,43),l(r,1),i.put("general_level_idc",l(r,8));for(var n=[],o=[],s=0;s<a;s++)n[s]=l(r,1),o[s]=l(r,1);if(a>0)for(s=a;s<8;s++)l(r,2);for(s=0;s<a;s++)n[s]&&(l(r,2),l(r,1),l(r,5),l(r,32),l(r,1),l(r,1),l(r,1),l(r,1),l(r,44)),o[s]&&l(r,8);var u=c(r,0);if(i.put("sps_seq_parameter_set_id",u),u>15)return!1;var f=c(r,0);return i.put("chroma_format_idc",f),!(u>3)&&(3==f&&l(r,1),i.put("pic_width_in_luma_samples",c(r,0)),i.put("pic_height_in_luma_samples",c(r,0)),l(r,1)&&(c(r,0),c(r,0),c(r,0),c(r,0)),c(r,0)==c(r,0))},getSizeInfo:function(){var e=i.get("pic_width_in_luma_samples"),t=i.get("pic_height_in_luma_samples");if(i.get("conformance_window_flag")){var r=i.get("chroma_format_idc"),a=i.get("separate_colour_plane_flag");"undefined"===typeof a&&(a=0);var n=1!==r&&2!==r||0!==a?1:2,o=1===r&&0===a?2:1;e-=n*i.get("conf_win_right_offset")+n*i.get("conf_win_left_offset"),t-=o*i.get("conf_win_bottom_offset")+o*i.get("conf_win_top_offset")}return{width:e,height:t,decodeSize:e*t}},getSpsValue:function(e){return i.get(e)},getCodecInfo:function(){return'video/mp4; codecs="hvc1.1.6.L30.B0"'}},new o}var l=function(){var e,t,r,a=0,s=0,l=!1,c=0,p=0,d=new f,m=new u,_={frameData:null,timeStamp:null,initSegmentData:null,mediaSample:null,dropPercent:0,dropCount:0,codecInfo:"",playback:!1},h={timestamp:null,timezone:null},g=0,v=0,y=null,b=0,D=0,S={width:0,height:0},T=0,w=0,E=null,M=null,C=null,I=!1,A=!1,x=!1,k={},O=!1,P=null;function F(){this.decoder=(0,i.default)(),this.firstTime=0,this.lastMSW=0}return F.prototype={setReturnCallback:function(e){this.rtpReturnCallback=e},setBufferfullCallback:function(e){null!==this.videoBufferList&&this.videoBufferList.setBufferFullCallback(e)},getVideoBuffer:function(e){if(null!==this.videoBufferList)return this.videoBufferList.searchNodeAt(e)},clearBuffer:function(){null!==this.videoBufferList&&this.videoBufferList.clear()},findCurrent:function(){null!==this.videoBufferList&&this.videoBufferList.searchTimestamp(this.getTimeStamp())},ntohl:function(e){return(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3]>>>0},appendBuffer:function(e,t,r){if(r+t.length>=e.length){var a=new Uint8Array(e.length+1048576);a.set(e,0),e=a}return e.set(t,r),e},setGovLength:function(e){y=e},getGovLength:function(){return y},setDecodingTime:function(e){this.decodingTime=e},getDropPercent:function(){return 0},getDropCount:function(){return 0},initStartTime:function(){this.firstDiffTime=0,this.calcGov=0},setCheckDelay:function(e){this.checkDelay=e},init:function(e){A=!1,l=!1,this.decoder.setIsFirstFrame(!1),this.videoBufferList=new n.VideoBufferList,this.firstDiffTime=0,this.checkDelay=!0,this.timeData=null,x=e.h265AccelerationEnabled},setInitSegment:function(){A=!1},parseRTPDataH265Acceleration:function(i,u,f,c,p){var m=null,y={},b=(u[19]<<24)+(u[18]<<16)+(u[17]<<8)+u[16]>>>0,T=Date.UTC("20"+(b>>26),(b>>22&15)-1,b>>17&31,b>>12&31,b>>6&63,63&b)/1e3;if(p.timeStampmsw,T-=28800,0==this.firstTime)this.firstTime=T,this.lastMSW=0,s=(u[21]<<8)+u[20],h={timestamp:this.firstTime,timestamp_usec:0};else{var w,x=(u[21]<<8)+u[20];w=x>s?x-s:x+65535-s,this.lastMSW+=w,T>this.firstTime&&(this.lastMSW-=1e3),this.firstTime=T,h={timestamp:T,timestamp_usec:this.lastMSW},s=x}0!==this.getFramerate()&&"undefined"!==typeof this.getFramerate()||"undefined"===typeof this.getTimeStamp()||(this.setFramerate(Math.round(1e3/((h.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(h.timestamp_usec-this.getTimeStamp().timestamp_usec)))),n.debug.log("setFramerate"+Math.round(1e3/((h.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(h.timestamp_usec-this.getTimeStamp().timestamp_usec))))),this.setTimeStamp(h);for(var F=u[22],L=u.subarray(24+F,u.length-8),R=u.subarray(u.length-8,u.length),U=(R[7],R[6],R[5],R[4],[]),B=0;B<=L.length;)if(0==L[B])if(0==L[B+1])if(1==L[B+2]){if(U.push(B),38==(255&L[B+=3])||2==(255&L[B]))break}else 0==L[B+2]?B++:B+=3;else B+=2;else B+=1;a=(u[21]<<8)+u[20];var z=0;for(B=0;B<U.length;B++)switch(m=L.subarray(U[B]+3,U[B+1]-1),255&L[U[B]+3]){case 2:z=U[B]-1,e=L.subarray(z,L.length);break;case 38:z=U[B]-1,e=L.subarray(z,L.length);var N=p;g=t=N.width,v=r=N.height,0===S.width&&0===S.height?(S.width=g,S.height=v,y.decodeStart=S,y.decodeStart.decodeMode="video",y.decodeStart.encodeMode="h265"):S.width===g&&S.height===v||(A=!1,S.width=g,S.height=v,y.resolution=S);break;case 64:E=m;break;case 66:var V=L.subarray(U[B]+5,U[B+1]-1);d.parse(V),C=m;break;case 68:M=m}if(A)_.initSegmentData=null;else{A=!0;var j=d.getSpsValue("general_profile_space"),H=d.getSpsValue("general_tier_flag"),W=d.getSpsValue("general_profile_idc"),G=d.getSpsValue("temporalIdNested");d.getSpsValue("general_profile_compatibility_flags"),d.getSpsValue("general_constraint_indicator_flags"),p={id:1,width:t,height:r,type:"video",general_profile_flag:j<<6|H<<5|W,general_profile_compatibility_flags:d.getSpsValue("general_profile_compatibility_flags"),general_constraint_indicator_flags:d.getSpsValue("general_constraint_indicator_flags"),general_level_idc:d.getSpsValue("general_level_idc"),chroma_format_idc:d.getSpsValue("chroma_format_idc"),bitDepthLumaMinus8:d.getSpsValue("bitDepthLumaMinus8"),bitDepthChromaMinus8:d.getSpsValue("bitDepthChromaMinus8"),rate_layers_nested_length:11|(1&G)<<2,vps:[E],sps:[C],pps:[M],timescale:1e3,fps:this.getFramerate()},null==P&&(P=new o.default(n.commonOption.VIDEOENCODETYPE.H265)),_.initSegmentData=P.initSegment(p),_.codecInfo=d.getCodecInfo()}z||n.debug.log("11111111111111111111111111111111111111111");var X=e.length-4;e[0]=(4278190080&X)>>>24,e[1]=(16711680&X)>>>16,e[2]=(65280&X)>>>8,e[3]=255&X;var q=this.getFramerate(),Y={duration:Math.round(1/q*1e3),size:e.length,frame_time_stamp:null,frameDuration:null};if(Y.frame_time_stamp=1e3*h.timestamp+h.timestamp_usec-D,!1===I)Y.frame_time_stamp=0,D=1e3*h.timestamp+h.timestamp_usec,Y.frameDuration=0,k=Y,I=!0;else{var J=k.frame_time_stamp,K=Y.frame_time_stamp;Y.frameDuration=Math.abs(K-J),Y.frameDuration>3e3&&(Y.frameDuration=0),k=Y}_.frameData=new Uint8Array(e),_.mediaSample=Y,h=null===h.timestamp?this.getTimeStamp():h,_.timeStamp=h;var Z=g*v;if(!0===l){var Q=(rtpDuration/frameDuration*100).toFixed(0)<60;Z>videoTagLimitSize?frameDuration<5e3?(changeMode("video"),y.decodeMode="video"):!0===Q?(changeMode("video"),y.decodeMode="video"):(changeMode("canvas"),y.decodeMode="canvas"):(changeMode("canvas"),y.decodeMode="canvas")}if(_.playback=l,y.decodedData=_,!0===O)return 2===errorIFrameNum&&(errorIFrameNum=0,O=!1),void n.debug.info("H264Session::stop");this.rtpReturnCallback(y)},parseRTPData:function(t,r,i,o,u){if(!0!==x){var f,d=null,y={},b=(r[19]<<24)+(r[18]<<16)+(r[17]<<8)+r[16]>>>0;f=b>>>26===0?"2000":"20"+(b>>>26);var E=Date.UTC(f,(b>>>22&15)-1,b>>>17&31,b>>>12&31,b>>>6&63,63&b)/1e3;if(E+=(new Date).getTimezoneOffset()/60*3600,0===this.firstTime)this.firstTime=E,this.lastMSW=0,s=(r[21]<<8)+r[20],h={timestamp:this.firstTime,timestamp_usec:0};else{var M,C=(r[21]<<8)+r[20];M=C>s?C-s:C+65535-s,this.lastMSW+=M,E>this.firstTime&&(this.lastMSW-=1e3),this.firstTime=E,h={timestamp:E,timestamp_usec:this.lastMSW},s=C}0!==this.getFramerate()&&"undefined"!==typeof this.getFramerate()||"undefined"===typeof this.getTimeStamp()||(this.setFramerate(Math.round(1e3/((h.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(h.timestamp_usec-this.getTimeStamp().timestamp_usec)))),n.debug.log("setFramerate"+Math.round(1e3/((h.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(h.timestamp_usec-this.getTimeStamp().timestamp_usec))))),this.setTimeStamp(h);var I=r[22];e=r.subarray(24+I,r.length-8),a=(r[21]<<8)+r[20];for(var A=[],k=0;k<=e.length;)if(0==e[k])if(0==e[k+1])if(1==e[k+2]){if(A.push(k),5==(31&e[k+=3])||1==(31&e[k]))break}else 0==e[k+2]?k++:k+=3;else k+=2;else k+=1;var O="P";for(k=0;k<A.length;k++)switch(d=e.subarray(A[k]+3,A[k+1]),e[A[k]+3]>>1&63){default:break;case 33:O="I",m.parse2(d);var P=u;p=m.getSizeInfo().decodeSize,g=P.width,v=P.height,S.width==P.width&&S.height==P.height||(0!=S.width?(S.width=P.width,S.height=P.height,y.resolution=S,y.resolution.decodeMode="canvas",y.resolution.encodeMode="h265"):(S.width=P.width,S.height=P.height,y.decodeStart=S,y.decodeStart.decodeMode="canvas",y.decodeStart.encodeMode="h265"))}var F=1e3*h.timestamp+h.timestamp_usec;0==this.firstDiffTime?(T=0,this.firstDiffTime=Date.now()-F,n.debug.log("firstDiff: "+D)):(F-w<0&&(this.firstDiffTime=T+(Date.now()-F).toFixed(0)),(T=Date.now()-F-this.firstDiffTime)<0&&(this.firstDiffTime=0,T=0),T>8e3&&(y.error={errorCode:n.PLAYER_STATE_CODE.TIMEOUT},this.rtpReturnCallback(y))),w=F,_.frameData=null,c!==p&&(this.decoder.free(),c=p,this.decoder.setOutputSize(c)),!0===i&&!0===l||(_.frameData=this.decoder.decode(r),_.frameData.frameType=O,_.frameData.frameIndex=u.frameIndex),_.timeStamp=null,h=null===h.timestamp?this.getTimeStamp():h,_.timeStamp=h,i&&(y.backupData={stream:e,frameType:O,width:g,height:v,codecType:"h265"},null!==h.timestamp&&"undefined"!==typeof h.timestamp?y.backupData.timestamp_usec=h.timestamp_usec:y.backupData.timestamp=(a/90).toFixed(0)),y.decodedData=_,this.rtpReturnCallback(y)}else this.parseRTPDataH265Acceleration(t,r,i,o,u)},findIFrame:function(){if(null!==this.videoBufferList){var e=this.videoBufferList.findIFrame();if(null===e||"undefined"===typeof e)return!1;var t={};return this.setTimeStamp(e.timeStamp),t.frameData=this.decoder.decode(e.buffer),t.timeStamp=e.timeStamp,t}},getFramerate:function(){return b},setFramerate:function(e){0<e&&"undefined"!==typeof e&&(b=e,null!==this.videoBufferList&&(this.videoBufferList.setMaxLength(6*b),this.videoBufferList.setBUFFERING(4*b)))},getTimeStamp:function(){return this.timeData},setTimeStamp:function(e){this.timeData=e}},new F};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(0);var n=function(){var e,t,r,n,i,o,s,u,f,l,c,p,d,m,_,h=!1,g=0;function v(){v.prototype.setIsFirstFrame(!1)}return v.prototype={init:function(){a.debug.log("H265 Decoder init")},setOutputSize:function(e){if(i!==2*e){i=2*e;var t=Module._malloc(1),r=new Uint8Array(Module.HEAPU8.buffer,t,1);Module._DECODE_GetFreePort(r.byteOffset),g=r[0],r=null,Module._free(t),Module._DECODE_Init(g),o=Module._malloc(5242880),s=new Uint8Array(Module.HEAPU8.buffer,o,5242880);var a=2*e;u=Module._malloc(a),f=new Uint8Array(Module.HEAPU8.buffer,u,a),l=Module._malloc(4),c=new Uint8Array(Module.HEAPU8.buffer,l,4),p=Module._malloc(40),d=new Uint8Array(Module.HEAPU8.buffer,p,40)}},decode:function(a,i){var o=a[4],u=a[5];e=Date.now(),s.set(a),Module._DECODE_InputOneFrame(g,s.byteOffset,a.length,f.byteOffset,c.byteOffset,d.byteOffset),n=d[16]+(d[17]<<8),r=d[18]+(d[19]<<8);var l=n*r*3/2;return _=null,m=null,_=new ArrayBuffer(l),(m=new Uint8Array(_)).set(Module.HEAPU8.subarray(f.byteOffset,f.byteOffset+l)),t=Date.now()-e,v.prototype.isFirstFrame()?n>0&&r>0?(e=Date.now(),{data:m,option:{ylen:n,height:r,mediaType:o,subMediaType:u,beforeDecoding:e},width:n,height:r,codecType:"h265",decodingTime:t,frameType:i}):void 0:(v.prototype.setIsFirstFrame(!0),{firstFrame:!0})},setIsFirstFrame:function(e){h=e},isFirstFrame:function(){return h},free:function(){Module._DECODE_Stop(g),s=null,Module._free(o),f=null,Module._free(u),c=null,Module._free(l),d=null,Module._free(p),_=null,m=null}},new v};t.default=n},function(e,t,r){"use strict";var a=r(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(0),i=a(r(14)),o=function(){var e=0,t=0,r={frameData:null,timeStamp:null},a={timestamp:null,timezone:null};var o=0,s=0,u=0,f=0,l=null,c=null,p=null,d=0,m=0,_=0,h={width:0,height:0};function g(){this.decoder=new i.default,this.firstTime=0,this.lastMSW=0}return g.prototype={init:function(){this.decoder.setIsFirstFrame(!1),this.videoBufferList=new n.VideoBufferList,this.timeData=null},parseRTPData:function(i,p,d,g,v){var y,b=new Uint8Array(1048576);e=v.width,t=v.height,l={};var D=p[22],S=p.subarray(24+D,p.length-8);c=S.length;var T=(p[19]<<24)+(p[18]<<16)+(p[17]<<8)+p[16]>>>0;y=T>>26===0?"2000":"20"+(T>>26);var w=Date.UTC(y,(T>>22&15)-1,T>>17&31,T>>12&31,T>>6&63,63&T)/1e3;if(w-=28800,0===this.firstTime)this.firstTime=w,this.lastMSW=0,f=(p[21]<<8)+p[20],a={timestamp:this.firstTime,timestamp_usec:0};else{var E,M=(p[21]<<8)+p[20];E=M>f?M-f:M+65535-f,this.lastMSW+=E,w>this.firstTime&&(this.lastMSW-=1e3),this.firstTime=w,a={timestamp:w,timestamp_usec:this.lastMSW},f=M}0!==this.getFramerate()&&"undefined"!==typeof this.getFramerate()||"undefined"===typeof this.getTimeStamp()||this.setFramerate(Math.round(1e3/((a.timestamp-this.getTimeStamp().timestamp===0?0:1e3)+(a.timestamp_usec-this.getTimeStamp().timestamp_usec)))),this.setTimeStamp(a),u=(p[21]<<8)+p[20],s=c,(b=this.appendBuffer(b,S,o))[(o+=c)+s-2]=255,b[o+s-1]=217,h.width==e&&h.height==t||(0!=h.width?(h.width=e,h.height=t,l.resolution=h,l.resolution.decodeMode="canvas",l.resolution.encodeMode="mjpeg"):(h.width=e,h.height=t,l.decodeStart=h,l.decodeStart.decodeMode="canvas",l.decodeStart.encodeMode="mjpeg"));var C=1e3*a.timestamp+a.timestamp_usec;0==this.firstDiffTime?(m=0,this.firstDiffTime=Date.now()-C,n.debug.log("firstDiff: "+this.firstTime)):(C-_<0&&(this.firstDiffTime=m+(Date.now()-C).toFixed(0)),(m=Date.now()-C-this.firstDiffTime)<0&&(this.firstDiffTime=0,m=0),m>8e3&&(l.error={errorCode:n.PLAYER_STATE_CODE.TIMEOUT},this.rtpReturnCallback(l))),_=C,r.frameData=null,this.decoder.setResolution(e,t),r.frameData=this.decoder.decode(b.subarray(0,o)),r.timeStamp=null,a=null===a.timestamp?this.getTimeStamp():a,r.timeStamp=a,!0===d&&(l.backupData={stream:b.subarray(0,o),width:e,height:t,codecType:"mjpeg"},null!==a.timestamp&&"undefined"!==typeof a.timestamp?l.backupData.timestamp_usec=a.timestamp_usec:l.backupData.timestamp=(u/90).toFixed(0)),o=0,r.playback=!1,l.decodedData=r,this.rtpReturnCallback(l)},getVideoBuffer:function(e){if(null!==this.videoBufferList)return this.videoBufferList.searchNodeAt(e)},clearBuffer:function(){null!==this.videoBufferList&&this.videoBufferList.clear()},findCurrent:function(){null!==this.videoBufferList&&this.videoBufferList.searchTimestamp(this.getTimeStamp())},findIFrame:function(){null!==this.videoBufferList&&this.videoBufferList.findIFrame()},SetRtpInterlevedID:function(e){this.interleavedID=e},setTimeStamp:function(e){this.timeData=e},getTimeStamp:function(){return this.timeData},getRTPPacket:function(e,t){},calculatePacketTime:function(e){},ntohl:function(e){return(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3]>>>0},appendBuffer:function(e,t,r){if(r+t.length>=e.length){var a=new Uint8Array(e.length+1048576);a.set(e,0),e=a}return e.set(t,r),e},setFramerate:function(e){0<e&&"undefined"!==typeof e&&(d=e,null!==this.videoBufferList&&(this.videoBufferList.setMaxLength(6*d),this.videoBufferList.setBUFFERING(4*d)))},getFramerate:function(){return d},setReturnCallback:function(e){this.rtpReturnCallback=e},setBufferfullCallback:function(e){null!==this.videoBufferList&&this.videoBufferList.setBufferFullCallback(e)},setGovLength:function(e){p=e},getGovLength:function(){return p},setDecodingTime:function(e){this.decodingTime=e},getDropPercent:function(){return 0},getDropCount:function(){return 0},initStartTime:function(){this.firstDiffTime=0,this.calcGov=0},setCheckDelay:function(e){this.checkDelay=e}},new g};t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(0);var n=function(){var e,t,r=!1;function n(){a.debug.log("MJPEG Decoder")}return n.prototype={setIsFirstFrame:function(e){r=e},isFirstFrame:function(){return r},setResolution:function(r,a){e=r,t=a},decode:function(r,a){return n.prototype.isFirstFrame()?{data:r,width:e,height:t,codecType:"mjpeg"}:(n.prototype.setIsFirstFrame(!0),{firstFrame:!0})}},new n};t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(0),n=function(){var e,t=null,r={1:"VideoSynopsis",2:"TrafficGate",3:"ElectronicPolice",4:"SinglePtzParking",5:"PtzParking",6:"Traffic",7:"Normal",8:"none",9:"ATM",10:"MetroIVS",11:"FaceDetection",12:"FaceRecognition",13:"NumberStat",14:"HeatMap",15:"VideoDiagnosis",16:"VideoEnhance",17:"SmokeFireDetect",18:"VehicleAnalyse",19:"PersonFeature",20:"SDFaceDetect",21:"HeatMapPlan",22:"ATMFD",23:"SCR",24:"NumberStatPlan",25:"CourseRecord",26:"Highway",27:"City",28:"LeTrack",29:"ObjectStruct",30:"Stereo",31:"StereoPc",32:"HumanDetect",33:"SDPedestrain",34:"FaceAnalysis",35:"FaceAttribute",36:"FacePicAnalyse",37:"SDEP",38:"XRayDetect",39:"ObjectDetect",40:"CrowdDistriMap",41:"StereoBehavior",57:"BoatDetection",67:"OperateMonitor",108:"ObjectMonitor",135:"ShopTruckDetect"};function n(){this.firstTime=0,this.lastMSW=0}function i(e){return new TextDecoder("utf-8").decode(e)}function o(e){var t=(255&e[3])<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0],r=(t>>23&255)-127;return((2147483648&t?-1:1)*(1+(8388607&t)/8388607)*Math.pow(2,r)).toFixed(3)}function s(e){var t={result:!0,type:0};return t.params=JSON.parse(i(e)),t}function u(e){var t={result:!1},a=0,n=(e[a+1]<<8)+e[a];if(1!==n&&2!==n)return t;t.result=!0,t.type=5,t.params=null;var i=e[a+=2];if(0===i)return t;var o=e[a+=1];a+=1,t.params={},t.params.coordinate=128&o?8192:1024,t.params.isTrack=!!(127&o),t.params.object=[];for(var s=0;s<i;s++){var u={};u.objectId=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],a+=4,u.operateType=e[a];var f=e[a+=1];a+=1,u.objectType=e[a];var l=e[a+=1];a+=1,a+=1,a+=1,u.classID=r[e[a]],a+=1,u.subType=e[a],a+=1,l>0&&(u.fatherId=[]);for(var c=0;c<l;c++)u.fatherId.push((e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]),a+=4;f>0&&(u.track=[]);for(var p=0;p<f;p++){var d=(e[a+1]<<8)+e[a],m=(e[(a+=2)+1]<<8)+e[a],_=(e[(a+=2)+1]<<8)+e[a],h=(e[(a+=2)+1]<<8)+e[a];a+=2,u.track.push([d-_,m-h,d+_,m+h])}t.params.object.push(u)}return t}function f(e){var t={result:!1},r=0,a=(e[r+1]<<8)+e[r],n=(e[(r+=4)+3]<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r];if(t.type=21,81===a){t.result=!0,t.params={},t.params.classType="VehiclesDistri",t.params.data=[];for(var i=(e[(r+=4)+1]<<8)+e[r];r<n&&i;)(u={}).PtzPresetId=e[r+=2],r+=1,u.ruleId=e[r],r+=1,u.ruleType=(e[r+1]<<8)+e[r],r+=2,u.maxNum=(e[r+1]<<8)+e[r],r+=2,u.carNum=(e[r+1]<<8)+e[r],t.params.data.push(u),i=(e[(r+=8)+1]<<8)+e[r]}else if(13===a){var o={16:"NumberStat",291:"QueueDetection",526:"ManNumDetection"},s=["enter","leave","in","cross","enterAgain","leaveAgain"];for(t.result=!0,t.params={},t.params.classType="NumberStat",t.params.data=[],r+=4;r<n;){var u,f=r;(u={data:{}}).ruleType=o[(e[(r+=2)+1]<<8)+e[r]];var l=f+(i=(e[(r+=4)+1]<<8)+e[r])-1;for(r+=2;r<l;){var c=e[r];u.data[c]||(u.data[c]={});var p=s[e[r+=1]-1],d=(e[(r+=3)+3]<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r];u.data[c][p]=d,r+=4}r=l+1,t.params.data.push(u)}}return t}function l(e){var t={result:!1},r=e.length;if(!e||r<8)return t;var a=0;if(2!==e[a])return t;var n=e[++a];if(n<0||n>16)return t;if(a++,a+=6,64!==(r-8)/n)return t;t.result=!0,t.type=23,t.params={waterLevel:[]};for(var i=function(){var t={point:[{nx:0,ny:0},{nx:0,ny:0}],fRealRuler:[0,0],textPos:{nx:0,ny:0}};return t.point[0].nx=(e[a+1]<<8)+e[a],a+=2,t.point[0].ny=(e[a+1]<<8)+e[a],a+=2,t.point[1].nx=(e[a+1]<<8)+e[a],a+=2,t.point[1].ny=(e[a+1]<<8)+e[a],a+=2,t.nUpdateInterval=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],a+=4,t.fLevel=o(e.slice(a,a+4)),a+=4,t.cStatus=e[a],a++,t.cColor=e[a],a++,a+=2,t.fRealRuler[0]=o(e.slice(a,a+4)),a+=4,t.fRealRuler[1]=o(e.slice(a,a+4)),a+=4,t.fDegree=o(e.slice(a,a+4)),a+=4,t.textPos.nx=(e[a+1]<<8)+e[a],a+=2,t.textPos.ny=(e[a+1]<<8)+e[a],a+=2,a+=28,t},s=0;s<n;s++)t.params.waterLevel.push(i());return t}function c(e){var t={type:25,params:[]};if(0===e[1])return t;for(var r=e.slice(8),a=r.length,n=0,i=function(){var e={};e.objectId=(r[n+3]<<24)+(r[n+2]<<16)+(r[n+1]<<8)+(r[n+0]<<0);var t=(r[(n+=4)+1]<<8)+(r[n+0]<<0),a=(r[(n+=2)+1]<<8)+(r[n+0]<<0),i=(r[(n+=2)+1]<<8)+(r[n+0]<<0),o=(r[(n+=2)+1]<<8)+(r[n+0]<<0);return n+=2,e.pos=[t,a,i,o],e.objectType=r[n],n+=1,n+=7,e};n<a;)t.params.push(i());return t}function p(e){for(var t={result:!1,type:20,params:[]},r=(e[0],e.length),a=0,n=e.slice(4),o=function(){var e={};e.objectId=(n[a+3]<<24)+(n[a+2]<<16)+(n[a+1]<<8)+(n[a+0]<<0),a+=4,e.result=!0,e.params={},e.custom=(n[a+1]<<8)+n[a],a+=2,e.objectStatus=n[a];var t=n[a+=1];a+=1,e.params.object=[];for(var r=null,o=0;o<t;o++){switch(n[a]){case 1:r=_(n.slice(a));break;case 2:r=m(n.slice(a));break;case 3:r=d(n.slice(a));break;case 4:r=h(n.slice(a))}e.params.object.push(r.info),a+=r.offset}1!=e.objectStatus&&3!=e.objectStatus||(e.params=null),0==t&&(e.params=null);var s=(n[a+1]<<8)+n[a];a+=2;var u=i(n.slice(a,a+s));return e.appendInfo=String.fromCharCode.apply(null,n.slice(a,a+s)),a+=s,e.appendInfo=u,e};a<r-4;)t.params.push(o());return t}function d(e){var t=0,r={type:e[0]};t+=1,r.pointCount=e[t],t+=1,r.lineWidth=e[t],t+=1,r.strokeStyle=e[t],t+=1,r.borderColor=[e[t+1],e[t+2],e[t+3],e[t]],r.borderColorType="RGBA",t+=4,r.fillColor=[e[t+1],e[t+2],e[t+3],e[t]],r.fillColorType="RGBA",t+=4,r.coordinate=[];for(var a=0;a<r.pointCount;a++){var n=(e[t+1]<<8)+e[t],i=(e[(t+=2)+1]<<8)+e[t];t+=2,r.coordinate.push([n,i])}return{info:r,offset:t}}function m(e){var t=0,r={type:e[0]};t+=1,r.pointCount=e[t],t+=1,r.lineWidth=e[t],t+=1,r.strokeStyle=e[t],t+=1,r.lineColor=[e[t+1],e[t+2],e[t+3],e[t]],r.lineColorType="RGBA",t+=4,r.coordinate=[];for(var a=0;a<r.pointCount;a++){var n=(e[t+1]<<8)+e[t],i=(e[(t+=2)+1]<<8)+e[t];t+=2,r.coordinate.push([n,i])}return{info:r,offset:t}}function _(e){var t=0,r={type:e[0]};t+=1,r.lineWidth=e[t],t+=1,r.strokeStyle=e[t],t+=1,t+=1,r.radius=(e[t+1]<<8)+e[t],t+=2;var a=(e[(t+=2)+1]<<8)+e[t],n=(e[(t+=2)+1]<<8)+e[t];return t+=2,r.coordinate=[a,n],r.borderColor=[e[t+1],e[t+2],e[t+3],e[t]],r.borderColorType="RGBA",t+=4,r.fillColor=[e[t+1],e[t+2],e[t+3],e[t]],r.fillColorType="RGBA",{info:r,offset:t+=4}}function h(e){var t=0,r={type:e[0]};t+=1,r.encodeType=e[t],t+=1;var a=(e[(t+=2)+1]<<8)+e[t],n=(e[(t+=2)+1]<<8)+e[t];t+=2,r.coordinate=[a,n],r.fontColor=[e[t+1],e[t+2],e[t+3],e[t]],t+=4,r.colorType="RGBA",r.fontSize=e[t],t+=1,r.textAlign=e[t],t+=1,r.textBaseline="top",r.textLength=(e[t+1]<<8)+e[t],t+=2;for(var o=e.slice(t,t+r.textLength),s=0;s<r.textLength;s++)if(0===o[s]){o=o.slice(0,s);break}try{r.content=i(o)}catch(e){r.content=""}return{info:r,offset:t+=r.textLength}}function g(e,t){t.hasOwnProperty("attribute80")||(t.attribute80=[]);var r=1,a=e[r];r+=1;var n={color:{}};n.color.valid=e[r],r+=1,n.carModel=e[r],r+=1,n.color.red=e[r],r+=1,n.color.green=e[r],r+=1,n.color.blue=e[r],r+=1,n.color.alpha=e[r],r+=1,n.brand=(e[r+1]<<8)+e[r],r+=2,n.subBrand=(e[r+1]<<8)+e[r],r+=2,n.year=(e[r+1]<<8)+e[r],r+=2,n.reliability=e[r],r+=1;var i=(e[(r+=1)+1]<<8)+e[r],o=(e[(r+=2)+1]<<8)+e[r],s=(e[(r+=2)+1]<<8)+e[r],u=(e[(r+=2)+1]<<8)+e[r];return r+=2,n.windowPosition=[i-s,o-u,i+s,o+u],t.attribute80.push(n),a}function v(e,t){t.hasOwnProperty("attribute81")||(t.attribute81=[]);var r={},a=1,n=e[a],i=(e[(a+=1)+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a];return a+=2,r.mainPosition=[i-s,o-u,i+s,o+u],i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],a+=2,r.coPosition=[i-s,o-u,i+s,o+u],r.mainSafetyBelt=e[a]>>2&3,r.coSafetyBelt=3&e[a],a+=1,r.mainSunvisor=e[a]>>2&3,r.coSunvisor=3&e[a],a+=1,t.attribute81.push(r),n}function y(e,t){t.hasOwnProperty("attribute82")||(t.attribute82=[]);var r={},a=1,n=e[a];return a+=1,r.plateEncode=e[a],a+=1,r.plateInfoLen=e[a],a+=1,r.plateInfo=e.subarray(a,a+r.plateInfoLen),t.attribute82.push(r),n}function b(e,t){t.hasOwnProperty("attribute83")||(t.attribute83=[]);var r={},a=1,n=e[a];return a+=1,r.color={},r.color.valid=e[a],a+=1,r.color.red=e[a],a+=1,r.color.green=e[a],a+=1,r.color.blue=e[a],a+=1,r.color.alpha=e[a],a+=1,r.country=String.fromCharCode.apply(null,e.subarray(a,a+4)),a+=4,r.plateType=(e[a+1]<<8)+e[a],a+=2,a+=1,r.plateWidth=(e[a+1]<<8)+e[a],t.attribute83.push(r),n}function D(e,t){t.hasOwnProperty("attribute84")||(t.attribute84=[]);var r={},a=1,n=e[a];a+=1,r.fatherCount=e[a],a+=1,r.trackCount=e[a],a+=1,r.trackType=e[a],a+=1,a+=3,r.fatherCount>0&&(r.fatherID=[]);for(var i=0;i<r.fatherCount;i++)r.fatherID.push((e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]),a+=4;r.trackCount>0&&(r.track=[]);for(var o=0;o<r.trackCount;o++){var s=(e[a+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a],l=(e[(a+=2)+1]<<8)+e[a];a+=2,r.track.push([s-f,u-l,s+f,u+l])}return t.attribute84.push(r),n}function S(e,t){t.hasOwnProperty("attribute85")||(t.attribute85=[]);var r={},a=1,n=e[a];a+=1,r.colorSpace=e[a],a+=1,r.mainColorCount=e[a],a+=1,r.mainColorCount>0&&(r.mainColorInfo=[]);for(var i=0;i<r.mainColorCount;i++){var o={},s=(e[a+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a],l=(e[(a+=2)+1]<<8)+e[a];a+=2,o.rect=[s-f,u-l,s+f,u+l],o.color=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],a+=4,r.mainColorInfo.push(o)}return t.attribute85.push(r),n}function T(e,t){t.hasOwnProperty("attribute86")||(t.attribute86=[]);var r={},a=1,n=e[a];return a+=1,a+=1,r.speedType=e[a],a+=1,r.speed=e[a+1]<<8+e[a],a+=2,r.speedX=e[a+1]<<8+e[a],a+=2,r.speedY=(e[a+1]<<8)+e[a],t.attribute86.push(r),n}function w(e,t){t.hasOwnProperty("attribute87")||(t.attribute87=[]);var r={},a=1,n=e[a];a+=1;var i=(e[(a+=2)+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a];return r.track=[[i-s,o-u,i+s,o+u]],t.attribute87.push(r),n}function E(e,t){t.hasOwnProperty("attribute88")||(t.attribute88=[]);var r={},a=1,n=e[a];return a+=1,r.age=e[a],a+=1,r.sex=e[a],a+=1,r.face=e[a],a+=1,r.glass=e[a],a+=1,r.hat=e[a],a+=1,r.call=e[a],a+=1,r.backpack=e[a],a+=1,r.umbrella=e[a],a+=1,r.height=e[a],a+=1,r.mask=e[a]>>2&3,r.beard=3&e[a],t.attribute88.push(r),n}function M(e,t){t.hasOwnProperty("attribute89")||(t.attribute89=[]);var r={},a=1,n=e[a];a+=1,r.yawAngle=parseInt((e[a+1]<<8)+e[a]),a+=2,r.rollAngle=parseInt((e[a+1]<<8)+e[a]),a+=2,r.pitchAngle=parseInt((e[a+1]<<8)+e[a]);var i=(e[(a+=2)+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a];a+=2,r.lEyePos=[i,o],i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],a+=2,r.rEyePos=[i,o],i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],a+=2,r.nosePos=[i,o],i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],a+=2,r.lMouthPos=[i,o],i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],a+=2,r.rMouthPos=[i,o];var s=e[a];a+=3,s>0&&(r.featurePos=[]);for(var u=0;u<s;u++)i=(e[a+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],a+=2,r.featurePos.push([i,o]);return t.attribute89.push(r),n}function C(e,t){t.hasOwnProperty("attribute8C")||(t.attribute8C=[]);var r={},a=1,n=e[a];a+=1,r.hangingCount=e[a],a+=1,r.tissueCount=e[a],a+=1,r.sunVisorCount=e[a],a+=1,r.annualInspectionCount=e[a],a+=1,a+=6,r.hangingCount>0&&(r.hangingCount=[]);for(var i=0;i<r.hangingCount;i++){var o=(e[a+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a];a+=2,r.hangingPos.push([o-u,s-f,o+u,s+f])}for(r.tissueCount>0&&(r.tissueCount=[]),i=0;i<r.tissueCount;i++)o=(e[a+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a],a+=2,r.tissueCount.push([o-u,s-f,o+u,s+f]);for(r.sunVisorCount>0&&(r.sunVisorCount=[]),i=0;i<r.tissueCount;i++)o=(e[a+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a],a+=2,r.sunVisorCount.push([o-u,s-f,o+u,s+f]);for(r.annualInspectionCount>0&&(r.annualInspectionCount=[]),i=0;i<r.tissueCount;i++)o=(e[a+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a],f=(e[(a+=2)+1]<<8)+e[a],a+=2,r.annualInspectionCount.push([o-u,s-f,o+u,s+f]);return t.attribute8C.push(r),n}function I(e,t){t.hasOwnProperty("attribute8E")||(t.attribute8E=[]);var r={},a=1,n=e[a];a+=1,r.nameCodecFormat=e[a];var i=e[a+=1];return a+=1,r.name=String.fromCharCode.apply(null,e.subarray(a,i)),t.attribute8E.push(r),n}function A(e,t){for(var r={128:g,129:v,130:y,131:b,132:D,133:S,134:T,135:w,136:E,137:M,140:C,142:I},a=0,n=e[a];a<e.length;){var i=e.subarray(a,e.length);a+=r[n].call(null,i,t)}}function x(e,t){t.hasOwnProperty("vehicleObject")||(t.vehicleObject=[]);var r={},a=0;r.type=e[a],a+=1;var n=(e[(a+=1)+1]<<8)+e[a];a+=2,r.objectId=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a];var i=(e[(a+=4)+1]<<8)+e[a],o=(e[(a+=2)+1]<<8)+e[a],s=(e[(a+=2)+1]<<8)+e[a],u=(e[(a+=2)+1]<<8)+e[a];return a+=2,r.track=[[i-s,o-u,i+s,o+u]],r.valid=e[a],a+=1,r.operateType=e[a],a+=1,a+=2,A(e.subarray(a,n),r),t.vehicleObject.push(r),n}function k(e,t){t.hasOwnProperty("faceObject")||(t.faceObject=[]);var r={},a=0;r.type=e[a],a+=1;var n=(e[(a+=1)+1]<<8)+e[a];return n<12?0:(a+=2,r.objectId=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],a+=4,r.version=e[a],a+=1,a+=3,r.faceData=e.subarray(a,n),t.faceObject.push(r),n)}function O(e,t){t.hasOwnProperty("commonObject")||(t.commonObject=[]);var r={},a=0;r.type=e[a],a+=1;var n=(e[(a+=1)+1]<<8)+e[a];return a+=2,r.objectId=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],a+=4,r.operateType=e[a],a+=1,r.beliefVal=e[a],a+=3,A(e.subarray(a,n),r),t.commonObject.push(r),n}function P(e,t,r){var a=0,n=(e[a+3]<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a],i=e[a+=4];if(a+=1,a+=3,0==i)return a;t.groupId=n,t.object={};for(var o=0;o<i;o++){var s=e[a],u=e.subarray(a,e.length),f=0;switch(s){case 2:case 5:f=x(u,t.object);break;case 15:f=k(u,t.object);break;default:f=O(u,t.object)}if(0==f)return 0;a+=f}return r(t),a}function F(e,t,r){var a={coordinate:8192};if(t.length<32)return!1;var n=4;a.classID=e;var i=t[n];if(0==i)return!0;a.groupCount=i,n+=1,n+=7,a.cameral=[];for(var o=0;o<20;o++)a.cameral.push(t[n+o]);n+=20;for(var s=0;s<a.groupCount;s++){var u=P(t.subarray(n,t.length),JSON.parse(JSON.stringify(a)),r);if(u<=0)break;n+=u}}return n.prototype={init:function(){a.debug.log("init")},parseRTPData:function(a,n,i,o,d,m){var _,h=(n[19]<<24)+(n[18]<<16)+(n[17]<<8)+n[16]>>>0;_=h>>26===0?"2000":"20"+(h>>26);var g=Date.UTC(_,(h>>22&15)-1,h>>17&31,h>>12&31,h>>6&63,63&h)/1e3;if(g-=28800,0===this.firstTime)this.firstTime=g,this.lastMSW=0,t=(n[21]<<8)+n[20],e={timestamp:this.firstTime,timestamp_usec:0};else{var v,y=(n[21]<<8)+n[20];v=y>=t?y-t:y+65535-t,this.lastMSW+=v,g>this.firstTime&&(this.lastMSW-=1e3),this.firstTime=g,e={timestamp:g,timestamp_usec:this.lastMSW},t=y}!function(t,a,n,i){var o=a[22],d=a.subarray(24+o,a.length-8);switch(t){case 0:n({ivsDraw:s(d),timeStamp:e,channel:i});break;case 5:n({ivsDraw:u(d),timeStamp:e,channel:i});break;case 6:break;case 14:var m=[];if(function(e,t){for(var a=e.length,n=0;n+4<a;){var i=e[n],o=(e[n+1],(e[n+3]<<8)+e[n+2]),s=e.subarray(n,o);if(n+=o,161!==i&&!F(r[i-64],s,t))break}}(d,function(e){m.push(e)}),m.length){var _={result:!1,type:14,params:m};n({ivsDraw:_,timeStamp:e,channel:i})}break;case 20:n({ivsDraw:p(d),timeStamp:e,channel:i});break;case 21:n({ivsDraw:f(d),timeStamp:e,channel:i});break;case 23:n({ivsDraw:l(d),timeStamp:e,channel:i});break;case 25:n({ivsDraw:c(d),timeStamp:e,channel:i})}}(n[5],n,this.rtpReturnCallback,m)},setBufferfullCallback:function(){},setReturnCallback:function(e){this.rtpReturnCallback=e}},new n};t.default=n}]);